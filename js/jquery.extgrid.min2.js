/*!artTemplate - Template Engine*/var template=function(a,b){return template["object"==typeof b?"render":"compile"].apply(template,arguments)};(function(a,b){"use strict";a.version="2.0.1",a.openTag="<%",a.closeTag="%>",a.isEscape=!0,a.isCompress=!1,a.parser=null,a.render=function(a,b){var c=d(a);return void 0===c?e({id:a,name:"Render Error",message:"No Template"}):c(b)},a.compile=function(b,d){function l(c){try{return new j(c)+""}catch(f){return h?(f.id=b||d,f.name="Render Error",f.source=d,e(f)):a.compile(b,d,!0)(c)}}var g=arguments,h=g[2],i="anonymous";"string"!=typeof d&&(h=g[1],d=g[0],b=i);try{var j=f(d,h)}catch(k){return k.id=b||d,k.name="Syntax Error",e(k)}return l.prototype=j.prototype,l.toString=function(){return""+j},b!==i&&(c[b]=l),l},a.helper=function(b,c){a.prototype[b]=c},a.onerror=function(a){var c="[template]:\n"+a.id+"\n\n[name]:\n"+a.name;a.message&&(c+="\n\n[message]:\n"+a.message),a.line&&(c+="\n\n[line]:\n"+a.line,c+="\n\n[source]:\n"+a.source.split(/\n/)[a.line-1].replace(/^[\s\t]+/,"")),a.temp&&(c+="\n\n[temp]:\n"+a.temp),b.console&&console.error(c)};var c={},d=function(d){var e=c[d];if(void 0===e&&"document"in b){var f=document.getElementById(d);if(f){var g=f.value||f.innerHTML;return a.compile(d,g.replace(/^\s*|\s*$/g,""))}}else if(c.hasOwnProperty(d))return e},e=function(b){function c(){return c+""}return a.onerror(b),c.toString=function(){return"{Template Error}"},c},f=function(){a.prototype={$render:a.render,$escape:function(a){return"string"==typeof a?a.replace(/&(?![\w#]+;)|[<>"']/g,function(a){return{"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"}[a]}):a},$string:function(a){return"string"==typeof a||"number"==typeof a?a:"function"==typeof a?a():""}};var b=Array.prototype.forEach||function(a,b){for(var c=this.length>>>0,d=0;c>d;d++)d in this&&a.call(b,this[d],d,this)},c=function(a,c){b.call(a,c)},d="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",e=/\/\*(?:.|\n)*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|'[^']*'|"[^"]*"|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g,f=/[^\w$]+/g,g=RegExp(["\\b"+d.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),h=/\b\d[^,]*/g,i=/^,+|,+$/g,j=function(a){return a=a.replace(e,"").replace(f,",").replace(g,"").replace(h,"").replace(i,""),a=a?a.split(/,+/):[]};return function(b,d){function w(b){return k+=b.split(/\n/).length-1,a.isCompress&&(b=b.replace(/[\n\r\t\s]+/g," ")),b=b.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n"),b=q[1]+"'"+b+"'"+q[2],b+"\n"}function x(b){var c=k;if(g?b=g(b):d&&(b=b.replace(/\n/g,function(){return k++,"$line="+k+";"})),0===b.indexOf("=")){var e=0!==b.indexOf("==");if(b=b.replace(/^=*|[\s;]*$/g,""),e&&a.isEscape){var f=b.replace(/\s*\([^\)]+\)/,"");m.hasOwnProperty(f)||/^(include|print)$/.test(f)||(b="$escape($string("+b+"))")}else b="$string("+b+")";b=q[1]+b+q[2]}return d&&(b="$line="+c+";"+b),y(b),b+"\n"}function y(a){a=j(a),c(a,function(a){l.hasOwnProperty(a)||(z(a),l[a]=!0)})}function z(a){var b;"print"===a?b=s:"include"===a?(n.$render=m.$render,b=t):(b="$data."+a,m.hasOwnProperty(a)&&(n[a]=m[a],b=0===a.indexOf("$")?"$helpers."+a:b+"===undefined?$helpers."+a+":"+b)),o+=a+"="+b+","}var e=a.openTag,f=a.closeTag,g=a.parser,h=b,i="",k=1,l={$data:!0,$helpers:!0,$out:!0,$line:!0},m=a.prototype,n={},o="var $helpers=this,"+(d?"$line=0,":""),p="".trim,q=p?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],r=p?"if(content!==undefined){$out+=content;return content}":"$out.push(content);",s="function(content){"+r+"}",t="function(id,data){if(data===undefined){data=$data}var content=$helpers.$render(id,data);"+r+"}";c(h.split(e),function(a){a=a.split(f);var c=a[0],d=a[1];1===a.length?i+=w(c):(i+=x(c),d&&(i+=w(d)))}),h=i,d&&(h="try{"+h+"}catch(e){"+"e.line=$line;"+"throw e"+"}"),h="'use strict';"+o+q[0]+h+"return new String("+q[3]+")";try{var u=Function("$data",h);return u.prototype=n,u}catch(v){throw v.temp="function anonymous($data) {"+h+"}",v}}}()})(template,this),"function"==typeof define?define(function(a,b,c){c.exports=template}):"undefined"!=typeof exports&&(module.exports=template);
/*
extgrid
http://www.extgrid.com/
*/
!function($){"use strict";$.dataGrid=function(a){this.init(a)},$.extGrid=$.dataGrid,$.dataGrid.fn={},$.dataGrid.fn.extend=function(a){$.extend($.dataGrid.prototype,a)},$.dataGrid.extend=function(a){$.extend($.dataGrid,a)},$.dataGrid.extend({version:"1.2.4.x",padding:8,puglins:[],getDefaults:function(a){var b={self:null,init:$.noop,title:"",iconCls:"",toolBars:!1,_toolItem:{text:"",cls:"",callBack:$.noop,disabled:!1},ltText:"",rowNumbersWidth:"0px",rowNumbersExpand:!1,rowNumbers2Row:!0,rowTpl:"",showHeader:!0,headerTpl:"",containerCss:"datagrid-container-border",border:!0,leftBorder:1,rightBorder:1,topBorder:1,bottomBorder:1,padding:$.dataGrid.padding,width:700,height:250,checkBox:!1,checkBoxWidth:"28px",checkBoxTitle:'<input type="checkbox">',checkBoxFit:!1,editColumn:!1,editColumnTitle:"操作",editColumnFit:!0,editCellW:63,columns:[],moveColumnTm:500,moveColumns:!0,_columnMetaData:{field:"",index:"",title:"",width:"120px",align:"left",_expand:!1,callBack:$.noop,hcls:"",bcls:"",fcls:"",sortable:!1,textLimit:!1,fitColumn:!0,disabled:!1},textLimit:!1,textLimitDef:"...",groupBy:!1,groupList:!1,groupListCallBack:$.noop,_groupListData:[],autoScrollToField:!0,autoScrollToRow:!0,scrollbarSize:!1,sTop:0,sLeft:0,_lTime:0,_lStart:0,_lSize:0,fitColumns:!0,data:[],emptyGridMsg:"",showEmptyGridMsg:!0,pk:"",lockRows:[],lockColumns:[],hideColumns:[],selectRows:[],isCreate:!1,isShow:!1,views:{},method:"post",url:"",loadMsg:"加载中,请稍后...",cache:!0,cacheData:[],pagination:!1,pagerToolBar:!1,pagerMsg:"当前显示 {start} 到 {end} 条，共 {total} 条",pageNumber:1,pageSize:10,dataType:"json",pageList:[10,20,30,40,50],queryParams:{},singleSelect:!1,sortName:"",sortOrder:"asc",rowStyler:"",rowCallBack:$.noop,tpl:{},methodCall:{},template:template,isEscape:!1,noop:$.noop,denyRowEvents:!1,events:{onStart:$.noop,onViewCreate:$.noop,onFinish:$.noop,onBeforeLoad:$.noop,onLoadSuccess:$.noop,onLoadError:$.noop,onClickRow:$.noop,onColumnOver:$.noop,onColumnOut:$.noop,onOverCell:$.noop,onOutCell:$.noop,onOverRow:$.noop,onOutRow:$.noop,onDblClickRow:$.noop,onClickCell:$.noop,onDblClickCell:$.noop,onSortColumn:$.noop,onResizeColumnStart:$.noop,onResizeColumn:$.noop,onResizeColumnStop:$.noop,onAfterResize:$.noop,onSelect:$.noop,onUnselect:$.noop,onSelectAll:$.noop,onUnselectAll:$.noop,onHeaderContextMenu:$.noop,onHeaderCreate:$.noop,onToolBarCreate:$.noop,onRowContextMenu:$.noop,onCellContextMenu:$.noop,onBeforeRefresh:$.noop,onRefresh:$.noop,onChangePageSize:$.noop,onShowGriding:$.noop,onShowGrid:$.noop,onBeforeShowGrid:$.noop,onGetData:$.noop,onPagerCreate:$.noop,onSelectPage:$.noop,onClickRowNumber:$.noop,onSearch:$.noop,onExpandRow:$.noop,onLockColumn:$.noop,onBeforeLockColumn:$.noop,onAfterLockColumn:$.noop,onAfterUnLockColumn:$.noop,onLockRow:$.noop,onBeforeLockRow:$.noop,onAfterLockRow:$.noop,onAfterUnLockRow:$.noop,onBeforeUnlockColumn:$.noop,onBeforeUnlockRow:$.noop,onViewSizeChange:$.noop,onSizeChange:$.noop,onScroll:$.noop,onDataChange:$.noop,onCellEdit:$.noop,onAdd:$.noop,onUpdate:$.noop,onDelete:$.noop,onAjaxAdd:$.noop,onAjaxUpdate:$.noop,onAjaxDelete:$.noop,onColumnMove:$.noop,onColumnMoving:$.noop,onColumnValueChange:$.noop}};return $.extend(b,a)},getToGridOptions:function(a){var b={options_from:"data-options",columns_from:"thead th",data_from:"tbody tr"};return $.extend(!0,b,a)},_undef:function(a,b){return void 0===a?b:a},_Tpl:{container:'<div class="datagrid-container <%=(border?containerCss:"")%>" id="<%=id%>" style=" position:relative; overflow:hidden; width:<%=width%>px; height:<%=height%>px;"></div>',title:'<div class="datagrid-title <%=iconCls%>" id="title_<%=id%>"><%=title%></div>',toolbar:'<div class="datagrid-toolbar" id="toolbar_<%=id%>"></div>',grid:'<div class="datagrid-view" id="view_<%=id%>" style="width:<%=width%>px; height:0px;"></div>',group_row:'<tr id="<%=id%>-group-row-<%=gid%>"  datagrid-group-row-id="<%=gid%>" class="datagrid-group-row"><td style="width:<%=w%>px" colspan="<%=colspan%>"><div  class="datagrid-group-cell"><%=html%>(<%=num%>)</div></td></tr>',view1:'<div class="datagrid-view1" id="view1_<%=id%>" style="width:<%=parseFloat(rowNumbersWidth)%>px;height:100%;"><div  class="datagrid-header" id="view1-datagrid-header-<%=id%>" style="width: 100%; z-index:40; position:relative;"><div class="datagrid-header-inner" id="view1-datagrid-header-inner-<%=id%>"><div class="datagrid-header-inner-wraper" id="datagrid-view1-header-inner-wraper-<%=id%>"><table class="datagrid-htable" id="view1-datagrid-header-inner-htable-<%=id%>" border="0" cellspacing="0" cellpadding="0"><tbody id="view1-datagrid-header-inner-htable-tbody-<%=id%>"><tr class="datagrid-header-row"><td align="center" class="datagrid-td-rownumber" style=""><div class="datagrid-header-rownumber" style="width:<%=parseFloat(rowNumbersWidth)%>px;"></div></td></tr></tbody></table></div></div><div class="datagrid-header-outer" id="view1-datagrid-header-outer-<%=id%>"><div class="datagrid-header-outer-wraper" id="datagrid-view1-header-outer-wraper-<%=id%>"><table class="datagrid-locktable" id="view1-datagrid-header-outer-locktable-<%=id%>" border="0" cellspacing="0" cellpadding="0"><tbody id="view1-datagrid-header-outer-locktable-tbody-<%=id%>"></tbody></table></div></div></div><div class="datagrid-body-wrap" id="view1-datagrid-body-wrap-<%=id%>" style="width: 100%; height:0px; overflow:hidden;zoom:1; "><div class="datagrid-body" id="view1-datagrid-body-<%=id%>" style="width: 100%;float:left;z-index:30;position:relative;"><table class="datagrid-btable" id="view1-datagrid-body-btable-<%=id%>" cellspacing="0" cellpadding="0" border="0"><tbody id="view1-datagrid-body-btable-tbody-<%=id%>"></tbody></table></div></div><div class="datagrid-footer" id="view1-datagrid-footer-<%=id%>" style="width: 100%; height:0px; overflow:hidden;position:relative;z-index:31;"></div></div>',view2:'<div class="datagrid-view2" id="view2_<%=id%>" style="width:0px;height:100%;"><div  class="datagrid-header" id="view2-datagrid-header-<%=id%>" style="width: 100%;"><div class="datagrid-header-inner" id="view2-datagrid-header-inner-<%=id%>"><div class="datagrid-header-inner-wraper" id="datagrid-view2-header-inner-wraper-<%=id%>"><table class="datagrid-htable" id="view2-datagrid-header-inner-htable-<%=id%>" border="0" cellspacing="0" cellpadding="0"><tbody id="view2-datagrid-header-inner-htable-tbody-<%=id%>"></tbody></table></div></div><div class="datagrid-header-outer" id="view2-datagrid-header-outer-<%=id%>"><div class="datagrid-header-outer-wraper" id="datagrid-view2-header-outer-wraper-<%=id%>"><table class="datagrid-locktable" id="view2-datagrid-header-outer-locktable-<%=id%>" border="0" cellspacing="0" cellpadding="0"><tbody id="view2-datagrid-header-outer-locktable-tbody-<%=id%>"></tbody></table></div></div></div><div class="datagrid-body" id="view2-datagrid-body-<%=id%>" style="width: 100%;height:0px;"><table class="datagrid-btable" id="view2-datagrid-body-btable-<%=id%>" cellspacing="0" cellpadding="0" border="0"><tbody id="view2-datagrid-body-btable-tbody-<%=id%>"></tbody></table></div><div class="datagrid-footer" id="view2-datagrid-footer-<%=id%>" style="width: 100%; height:0px; overflow:hidden;"></div></div>',pager:'<div class="datagrid-pager pagination" id="<%=id%>_pager"> <table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td><select class="pagination-page-list"><% var s = ""; for(var i=0;i<pageList.length;i++) {%><% if(pageList[i] == pageSize) {%><% s="selected";%><% } else {s="";} %><option value="<%=pageList[i]%>" <%=s%> ><%=pageList[i]%></option><% } %></select></td><td><div class="pagination-btn-separator"></div></td><td><a href="javascript:void(0)" class="pagination-first-btn p-plain <%=(pageNumber <= 1 )?"p-btn-disabled":""%>"><span class="pagination-first  p-btn">&nbsp;</span></a></td><td><a href="javascript:void(0)" class="pagination-prev-btn p-plain <%=(pageNumber <= 1 )?"p-btn-disabled":""%>"><span class="pagination-prev  p-btn">&nbsp;</span></a></td><td><div class="pagination-btn-separator"></div></td><td><span style="padding-left:6px;">第</span></td><td><input class="pagination-num" type="text" value="<%=pageNumber%>" size="2"></td><td><span style="padding-right:6px;">页 共 <%=pages%> 页</span></td><td><div class="pagination-btn-separator"></div></td><td><a href="javascript:void(0)" class="pagination-next-btn p-plain <%=(pageNumber >= pages)?"p-btn-disabled":""%>"><span class="pagination-next p-btn">&nbsp;</span></a></td><td><a href="javascript:void(0)" class="pagination-last-btn p-plain <%=(pageNumber >= pages)?"p-btn-disabled":""%>"><span class="pagination-last p-btn ">&nbsp;</span></a></td><td><div class="pagination-btn-separator"></div></td><td><a href="javascript:void(0)" class="pagination-load-btn p-plain"><span class="pagination-load p-btn">&nbsp;</span></a></td><td id="pagination-toolbar-<%=id%>"></td></tr></tbody></table><div class="pagination-info"><%=pagerMsg%></div><div style="clear:both;"></div></div>',view1_header_inner_row:'<tr class="datagrid-header-row"><td align="center" class="datagrid-td-rownumber" style=""><div class="datagrid-header-rownumber" style="width:<%=parseFloat(rowNumbersWidth)%>px;"><%=ltText%></div></td></tr>',view1_header_outer_row:"",view2_header_inner_row:'<tr class="datagrid-header-row"><% var i=0;len = fields.length;  for(;i<len;i++) {%><td field="<%=fields[i]["field"]%>" align="<%=fields[i]["align"]%>"><div class="datagrid-header-wrap" field="<%=fields[i]["field"]%>" ><div class="datagrid-cell datagrid-cell-<%=fields[i]["field"]%> datagrid-cell-header-<%=fields[i]["field"]%> <%=fields[i]["hcls"]%>" ><span><%=fields[i]["title"]%></span><span class="datagrid-sort-icon">&nbsp;</span></div></div></td><% } %></tr>',view2_header_outer_row:"",view1_row:"",view2_row:""}}),$.dataGrid.fn.extend({init:function(a){var c,b=this;b.initEvents(a),b.configs=$.extend({},$.dataGrid.getDefaults(),a),c=b.configs,c.self=b,c.template.isEscape=c.isEscape,c.template.helper("parseInt",parseInt),c.template.helper("parseFloat",parseFloat),c.border&&(c.width-=c.leftBorder+c.rightBorder,c.height-=c.topBorder+c.bottomBorder),c.id=c.id||b.getId(),c.gid=c.gid||"#view_"+c.id,c.rowNumbersWidth=parseFloat(c.rowNumbersWidth)>=0?c.rowNumbersWidth:!1,c.rowNumbersWidth===!1&&(c.rowNumbersWidth=0==c.groupBy?!1:"0px"),c.rowNumbersWidth===!1&&(c.rowNumbersWidth=c.lockColumns.length?"0px":!1),c.init.call(b,c),b.sysEvents(),b.fireEvent("onStart",[c]),b.setContainer().setTitle().setToolBar().setGrid().setPager(!0).show()},inArray:function(a,b){var c,d;if(b)for(c=b.length,d=0;c>d;d++)if(d in b&&b[d]==a)return d;return-1},tpl:function(a,b){var e,f,g,c=this,d=c.configs;return"undefined"==typeof a&&(a=""),"undefined"==typeof b&&(b={}),e={},"undefined"==typeof d.cacheData._tpl_?(d.cacheData._tpl_={},e=d.cacheData._tpl_):e=d.cacheData._tpl_,template.isEscape=d.isEscape,f="",a in d.tpl&&d.tpl[a]?d.tpl[a]in e?(g=e[d.tpl[a]],f=g(b)):(g=d.template.compile(d.tpl[a]),e[d.tpl[a]]=g,f=g(b)):a in c?f=c[a](b):a in $.dataGrid._Tpl&&$.dataGrid._Tpl[a]?$.dataGrid._Tpl[a]in e?(g=e[$.dataGrid._Tpl[a]],f=g(b)):(g=d.template.compile($.dataGrid._Tpl[a]),e[$.dataGrid._Tpl[a]]=g,f=g(b)):a.toString()in e?(g=e[a.toString()],f=g(b)):(g=d.template.compile(a.toString()),e[a.toString()]=g,f=g(b)),f},bind:function(a,b,c){var d,e,f,g;return"undefined"==typeof a?this:(b=b||$.noop,d=this,e=d.configs.events,e[a]=$.dataGrid._undef(e[a],[]),$.isFunction(e[a])&&(e[a]=[]),f={scope:c?c:d,func:b},g=e[a].push(f),g-1)},unbind:function(a,b){var c=this,d=c.configs.events;return b=$.dataGrid._undef(b,!1),b===!1?d[a]=$.noop:d[a][b]=$.noop,c},fireEvent:function(a,b){var e,f,g,c=this,d=c.configs.events[a];if(b=$.dataGrid._undef(b,[]),e=!0,$.isArray(d)){for(f=0;f<d.length;f++)if(g=d[f],$.isPlainObject(g)){if(e=g.func.apply(g.scope,b),e===!1)break}else if($.isFunction(g)&&(e=g.apply(c,b),e===!1))break}else $.isFunction(d)&&(e=d.apply(c,b));return e},loadPuglins:function(){var a=this;$.each($.dataGrid.puglins,function(){$.isFunction(this)&&this.call(a)})},initEvents:function(a){var d,c=a.events?a.events:{};if($.isPlainObject(c)&&!$.isEmptyObject(c))for(d in c)$.isFunction(c[d])&&c[d]!==$.noop&&(c[d]=[c[d]])},sysEvents:function(){var a=this;a.configs,a.bind("onShowGrid",a.autoExpand),a.bind("onClickRow",a.setExpandEvent),a.bind("onUnselectAll",function(){this.checkCk(!1)}),a.bind("onSelectAll",function(){this.checkCk(!0)}),a.bind("onUnselect",function(){this.checkCk(!1)}),a.bind("onShowGrid",function(){this.checkCk(!1)}),a.bind("onViewCreate",a.onInitFieldWidth),a.bind("onLoadSuccess",a.onLoadSuccess),a.bind("onLoadError",a.onLoadError),a.bind("onSetPk",a.setPk),a.bind("onViewSizeChange",a.onViewSizeChange),a.bind("onSizeChange",a.onSizeChange),a.bind("onSizeChange",a.onFinishFieldWidth),a.bind("onShowGrid",a.resetHeader),a.bind("onShowGrid",a.onLockRow),a.bind("onShowGrid",a.onLockColumn),a.bind("onScroll",a.onScroll),a.bind("onAfterLockRow",a.onAfterLockRow),a.bind("onAfterLockColumn",a.onAfterLockColumn),a.bind("onDataChange",a.onDataChange),a.bind("onOverRow",a.onOverRow),a.bind("onOutRow",a.onOutRow),a.bind("onShowGrid",a.onDisplayField),a.bind("onViewSizeChange",a.isEmptyGrid),a.bind("onHeaderCreate",a.onHeaderCreate),a.bind("onColumnMove",a.onColumnMove),a.bind("onFinish",a.loadPuglins),a.bind("onColumnValueChange",a.onColumnValueChange),a.bind("onSelect",a.addSelectRecode),a.bind("onUnselect",a.removeSelectRecode)},getId:function(){return"datagrid_"+Math.floor(99999*Math.random())},unique:function(){return"unique_"+Math.floor(99999*Math.random())},isNumber:function(a){return/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(a)?!0:!1},showLoading:function(a,b){var e,f,g,h,c=this,d=c.configs;return a="undefined"==typeof a?d.loadMsg:a,b="#"+d.id,e=$("#"+d.id+"_datagrid-mask-wraper"),e.length?(e.show(),c):(f=$('<div id="'+d.id+'_datagrid-mask-wraper" class="datagrid-mask-wraper"><div id="'+d.id+'_datagrid-mask" class="datagrid-mask"></div><div id="'+d.id+'_datagrid-mask-spacer" class="datagrid-mask-spacer"></div><div id="'+d.id+'_datagrid-mask-msg" class="datagrid-mask-msg" style=" left: 50%;">'+a+"</div><div>"),$(b).append(f),g=$("#"+d.id+"_datagrid-mask-msg"),h=g.outerWidth(!0),g.css("marginLeft",-h/2+"px"),f.click(function(a){a.stopPropagation(),a.preventDefault()}),c)},hideLoading:function(){var b=this,c=b.configs;return setTimeout(function(){$("#"+c.id+"_datagrid-mask-wraper").hide()},0),b},methodCall:function(a){var b,c;return a=a||"",b=this,c=b.configs,""!=a&&a in c.methodCall&&$.isFunction(c.methodCall[a])&&c.methodCall[a].call(b),b},getColumnData:function(a,b,c){var f,g,h,d=this,e=d.configs;if(a=$.dataGrid._undef(a,!1),b=$.dataGrid._undef(b,!1),a===!1)return d;for(f=e.columns,g=0,h=f.length;h>g;g++)if(f[g].field==a)return b===!1?f[g]:"undefined"==typeof c?f[g][b]:(f[g][b]=c,e.columns=f,d.fireEvent("onColumnValueChange",[f[g],b,c]),d);return null},setColumnData:function(a,b,c){var d=this;return d.getColumnData(a,b,c)},onColumnValueChange:function(a,b,c){var d=this,e=d.configs;switch(b){case"width":d.setFieldWidth(a.field,c);break;case"title":$(".datagrid-cell-header-"+a.field+" >span:first",$("#"+e.id)).html(c);break;case"field":d.setFieldWidth(c,a[c].width);break;default:d.setGridHeader(),d.refreshDataCache()}},getData:function(){var a=this,b=a.configs,c=a.getAsync();return c?b.cacheData.source:b.data},textLimit:function(a,b,c){var f,g,h,i,j,d=this,e=d.configs;if(a=$.dataGrid._undef(a,""),""==a)return a;for(a=new String(a),f=$("<div style='position:absolute;left:-1000px;'></div>"),f.appendTo(document.body),f.css({fontSize:c}),g=a.length,h="",i=0,j=1;g>=j&&(h=a.substr(0,j),f.html(h+e.textLimitDef),parseFloat(f.width())<parseFloat(b));j++)i=j;return f.remove(),a=0==i?a.substr(0,1)+e.textLimitDef:i==g?a:a.substr(0,i)+e.textLimitDef,a.toString()},getTpl:function(a){return a},setContainer:function(a){var b,c;return a=a||{},b=this,a=b.configs,c=b.tpl("container",a),a.helper.html(c),b},setTitle:function(a){var d,b=this,c=b.configs;return c.title="undefined"==typeof a?c.title:a,""==c.title?b:(d=b.tpl("title",c),b.configs.views.title=$(d),b)},getTools:function(a){var d,e,f,g,h,i,b=this,c=b.configs;if($.isPlainObject(a)&&(a=[a]),!$.isArray(a)&&!$.isPlainObject(a))return $(a);for(d=c._toolItem,e='<table cellspacing="0" cellpadding="0" border="0"><tbody><tr>{$tools}</tr></tbody></table>',f="",g=0,h=a.length;h>g;g++)$.isPlainObject(a[g])?(a[g]=$.extend({},d,a[g]),""!=a[g].cls&&(a[g].cls+=" l-btn-icon-left"),i=a[g].disabled?"l-btn-disabled":"",f+='<td><a href="javascript:void(0)" class="l-btn l-btn-plain '+i+'" indexid="'+g+'"><span class="l-btn-left"><span class="l-btn-text '+a[g].cls+'">'+a[g].text+"</span></span></a></td>"):f+="|"==a[g]||"-"==a[g]||";"==a[g]||","==a[g]?'<td><div class="datagrid-btn-separator"></div></td>':"<td>"+a[g]+"</td>";return e=e.replace("{$tools}",f),e=$(e),e.find(".l-btn").each(function(){$(this).click(function(c){var d=$(this).attr("indexid");a[d].callBack.call(b,this,a[d]),c.stopPropagation(),c.preventDefault()})}),e},setToolBar:function(){var c,d,a=this,b=a.configs;return b.toolBars===!1?a:(c=a.tpl("toolbar",b),a.configs.views.toolbar=$(c),d=a.getTools(b.toolBars),d!==!1&&a.configs.views.toolbar.append(d),a.fireEvent("onToolBarCreate",[a.configs.views.toolbar,b.toolBars]),a.methodCall("setToolBar"),a)},setGrid:function(){var d,e,f,g,a=this,b=a.configs,c=b.views;if(c.grid){e=c.grid,f=0;for(g in c)"grid"!=g&&(f+=c[g].outerHeight(!0));e.height(b.height-f)}else d=a.tpl("grid",b),a.configs.views.grid=$(d);return a.methodCall("setGrid"),a},autoExpand:function(){for(var a=this,b=a.configs,c=0,d=b.data.length;d>c;c++)$.isPlainObject(b.data[c])&&"_expand"in b.data[c]&&"_openExpand"in b.data[c]&&b.data[c]._openExpand&&a.expandRow(c,b.data[c]._expand)},checkCk:function(a){var b=this,c=b.configs;c.gid,a=$.dataGrid._undef(a,!1),$("#view2-datagrid-header-inner-htable-tbody-"+c.id).find(">.datagrid-header-row td[field='ck']").find("input:checkbox").each(function(){this.checked=a?!0:!1})},setExpandEvent:function(a,b,c){var d=this;d.configs,$.isPlainObject(c)&&"_expand"in c&&(d.isExpandRowShow(b)?d.hideExpandRow(b):d.expandRow(b,c._expand))},getScrollbarSize:function(){var c,d,a=this,b=a.configs;return b.scrollbarSize||(c=document.body,d=document.createElement("div"),d.style.width=d.style.height="100px",d.style.overflow="scroll",d.style.position="absolute",c.appendChild(d),b.scrollbarSize={width:d.offsetWidth-d.clientWidth,height:d.offsetHeight-d.clientHeight},c.removeChild(d)),b.scrollbarSize},scrollToField:function(a){var e,f,g,h,i,j,k,l,m,n,o,b=this,c=b.configs,d=$("#view2-datagrid-header-"+c.id);return d.length?(e=b.getColumnList(),-1==b.inArray(a,e)?b:-1!=b.inArray(a,c.lockColumns)?b:-1!=b.inArray(a,c.hideColumns)?b:(f=b.getScrollbarSize(),g=d.offset(),h=d.outerWidth(),i=$("#view2-datagrid-body-"+c.id),j=i.get(0).scrollHeight,j>i.outerHeight()&&(h-=f.width),k=$(">tr.datagrid-header-row td[field='"+a+"']","#view2-datagrid-header-inner-htable-tbody-"+c.id),k.length?(l=k.offset(),m=k.outerWidth(),n=0,g.left>l.left?n=g.left-l.left:g.left+h<l.left+m&&(n=g.left+h-(l.left+m)),o=0,o=c.sLeft-n,c.sLeft=o,b.fireEvent("onScroll",[!0]),b):b)):b},scrollToRow:function(a){var e,f,g,h,i,j,k,l,m,b=this,c=b.configs,d=$("#view2-datagrid-body-"+c.id);return d.length?-1!=b.inArray(a,c.lockRows)?b:(e=b.getScrollbarSize(),f=d.offset(),g=d.outerHeight(),h=d.get(0).scrollWidth,h>d.outerWidth()&&(g-=e.height),i=$("#"+c.id+"-row-"+a),i.length?(j=i.offset(),k=i.outerHeight(),l=0,f.top>j.top?l=f.top-j.top:f.top+g<j.top+k&&(l=f.top+g-(j.top+k)),m=0,m=c.sTop-l,c.sTop=m,b.fireEvent("onScroll",[!0]),b):b):b},addPagerEvent:function(){var a=this,b=a.configs,c=b.views.pager;return c.find("a.pagination-first-btn").click(function(){$(this).hasClass("p-btn-disabled")||(b.pageNumber=1,a.refreshData())}),c.find("a.pagination-prev-btn").click(function(){if(!$(this).hasClass("p-btn-disabled")){var c=b.pageNumber-1;b.pageNumber=0>=c?1:c,a.refreshData()}}),c.find("a.pagination-next-btn").click(function(){var c,d,e;$(this).hasClass("p-btn-disabled")||(c=b.total||b.data.length,d=Math.ceil(parseInt(c)/parseInt(b.pageSize)),e=b.pageNumber+1,b.pageNumber=e>d?d:e,a.refreshData())}),c.find("a.pagination-last-btn").click(function(){var c,d;$(this).hasClass("p-btn-disabled")||(c=b.total||b.data.length,d=Math.ceil(parseInt(c)/parseInt(b.pageSize)),b.pageNumber=d,a.refreshData())}),c.find("a.pagination-load-btn").click(function(){$(this).hasClass("p-btn-disabled")||a.refreshData()}),c.find(".pagination-page-list").change(function(){var f,c=b.total||b.data.length,d=$(this).val(),e=Math.ceil(parseInt(c)/parseInt(d));return b.pageNumber>e&&(b.pageNumber=e),f=a.fireEvent("onChangePageSize",[d]),f===!1?!1:(b.pageSize=d,f=a.fireEvent("onSelectPage",[d]),f===!1?!1:(a.refreshData(),void 0))}),c.find(".pagination-num").keydown(function(d){13===d.keyCode&&(b.pageNumber=parseInt(c.find(".pagination-num").val()),b.pageNumber=a.isNumber(b.pageNumber)?b.pageNumber:1,a.refreshData())}),a},setPager:function(a){var d,e,f,b=this,c=b.configs;return a=$.dataGrid._undef(a,!1),c.pagination?(d={},d.id=c.id,d.total=c.total||c.data.length,d.pageSize=c.pageSize,d.pageNumber=c.pageNumber,d.pageList=c.pageList,d.pages=Math.ceil(parseInt(d.total)/parseInt(d.pageSize)),c.pageNumber=c.pageNumber>d.pages?d.pages:c.pageNumber,c.pageNumber=c.pageNumber<=0?1:c.pageNumber,d.pageNumber=c.pageNumber,d.start=d.pageNumber*d.pageSize-d.pageSize+1<0?0:d.pageNumber*d.pageSize-d.pageSize+1,d.end=d.pageNumber*d.pageSize,d.pagerMsg=c.pagerMsg.replace("{start}",d.start).replace("{end}",d.end).replace("{total}",d.total),e=$("#"+c.id+"_pager"),f=b.tpl("pager",d),e.size()?(c.views.pager=$(f),e.after(c.views.pager),e.remove()):c.views.pager=$(f),a?b:(b.addPagerEvent(),$.isArray(c.pagerToolBar)&&c.pagerToolBar.length&&$("#pagination-toolbar-"+c.id).append(b.getTools(c.pagerToolBar)),b.fireEvent("onPagerCreate",[c.views.pager]),b.methodCall("setPager"),b)):b},onSizeChange:function(a,b){var e,f,g,h,c=this,d=c.configs;d.width=$.dataGrid._undef(a,d.width),d.height=$.dataGrid._undef(b,d.height),d.border&&(d.width-=d.leftBorder+d.rightBorder,d.height-=d.topBorder+d.bottomBorder),$("#"+d.id).css({width:d.width,height:d.height}),$("#view_"+d.id).css({width:d.width}),e=d.views,f=e.grid,g=0;for(h in e)"grid"!=h&&(g+=e[h].outerHeight(!0));f.height(d.height-g),c.fireEvent("onViewSizeChange",[])},onViewSizeChange:function(){var f,g,h,i,j,k,l,m,a=this,b=a.configs,c=b.gid,d=$(c).width();$(c).height(),b.helper.is(":hidden")&&(f=$("<div></div>").appendTo(document.body),f.css({position:"absolute",top:9999}),f.append($("#"+b.id))),g=$("#view1_"+b.id),h=$("#view2_"+b.id),i=$("#view1-datagrid-header-inner-htable-"+b.id).outerWidth(),g.width(i),h.width(d-parseFloat(i)),j=$("#view2-datagrid-header-inner-htable-"+b.id).outerHeight(),$("#view1-datagrid-header-inner-htable-"+b.id).height(j),j=parseFloat(j)-1,b.showHeader||(j=0),$("#view1-datagrid-header-inner-"+b.id).height(j),$("#view2-datagrid-header-inner-"+b.id).height(j),k=$("#view2-datagrid-header-outer-locktable-"+b.id).outerHeight(),$("#view1-datagrid-header-outer-"+b.id).height(k),$("#view2-datagrid-header-outer-"+b.id).height(k),l=parseFloat($("#view2-datagrid-header-inner-"+b.id).outerHeight())+parseFloat($("#view2-datagrid-header-outer-"+b.id).outerHeight()),$("#view1-datagrid-header-"+b.id).height(l),$("#view2-datagrid-header-"+b.id).height(l),m=h.height()-b.gheader.height()-b.gfooter.height(),b.gbody.height(m),$("#view1-datagrid-body-wrap-"+b.id).height(m),a.fireEvent("onScroll",[]),b.helper.is(":hidden")&&(b.helper.append($("#"+b.id)),f.remove())},array_sort:function(a,b,c,d){var e,f,g,h,i,j,k,l;if(b==c)return a;for(e=a,a=[],f=0,g=e.length;g>f;f++)h=a.push(f),f==b?b=h-1:f==c&&(c=h-1);if(i=a[b],b>c)for(d||c++,j=b;j>=0;j--){if(j==c){a[j]=i;break}a[j]=a[j-1]}else if(c>b)for(d&&c--,j=b;c>=j;j++)a[j]=j==c?i:a[j+1];for(k=[],l=0,g=a.length;g>l;l++)k.push(e[a[l]]);return a=k},onColumnMove:function(a){var c,d,e,f,g,h,i,b=this;if(a=b.configs,c=a.columns,d=0,e=0,f=a.moveToFieldPos,a.moveField!=a.moveToField&&-1==b.inArray(a.moveField,a.lockColumns)&&-1==b.inArray(a.moveToField,a.lockColumns)){for(g=0,h=c.length;h>g;g++)c[g].field==a.moveField&&(d=g),c[g].field==a.moveToField&&(e=g);if(c=a.columns=b.array_sort(c,d,e,f),f)for(d=$("#view2-datagrid-header-inner-htable-tbody-"+a.id).find("td[field='"+a.moveField+"']"),e=$("#view2-datagrid-header-inner-htable-tbody-"+a.id).find("td[field='"+a.moveToField+"']"),e.before(d),i=0,h=a.data.length;h>i;i++)d=$("#"+a.id+"-row-"+i).find("td[field='"+a.moveField+"']"),e=$("#"+a.id+"-row-"+i).find("td[field='"+a.moveToField+"']"),e.before(d);else for(d=$("#view2-datagrid-header-inner-htable-tbody-"+a.id).find("td[field='"+a.moveField+"']"),e=$("#view2-datagrid-header-inner-htable-tbody-"+a.id).find("td[field='"+a.moveToField+"']"),e.after(d),i=0,h=a.data.length;h>i;i++)d=$("#"+a.id+"-row-"+i).find("td[field='"+a.moveField+"']"),e=$("#"+a.id+"-row-"+i).find("td[field='"+a.moveToField+"']"),e.after(d)}},setView:function(){var a=this,b=a.configs,c=a.tpl(a.getTpl("view1"),b),d=a.tpl(a.getTpl("view2"),b),e=b.gid;$(e).html(""),$(c).appendTo(e),$(d).appendTo(e),b.gheader=$("#view2-datagrid-header-"+b.id),b.gbody=$("#view2-datagrid-body-"+b.id),b.gfooter=$("#view2-datagrid-footer-"+b.id),b.gbody.scroll(function(){a.fireEvent("onScroll",[])})},getRowData:function(a,b){var e,f,g,h,c=this,d=c.configs;if(b=$.dataGrid._undef(b,!1),e=b?c.getData():d.data,!b)return e[a];for(f=d.pk,g=0,h=e.length;h>g;g++)if(e[g][f]==a)return e[g];return!1},setRowData:function(a,b,c){var g,d=this,e=d.configs,f=e.data;return f[a][b]=c,g=!1,"undefined"!=typeof f[a].pk&&(g=d.getRowData(f[a].pk,!0),g&&(g[b]=c)),d},getRealField:function(a){var d,b=this;return b.configs,"undefined"==typeof a?null:(d=a,a=b.getColumnData(a,"index"),a=""==a?d:a)},getFieldValue:function(a,b){var e,c=this;return c.configs,b=c.getRealField(b),e=this.getRowData(a),e[b]},setFieldValue:function(a,b,c){var g,h,i,j,k,d=this,e=d.configs;return e.gid,g=d.getRealField(b),h=d.getRowData(a),h[g]==c?!1:(i="#"+e.id+"-row-"+a+",#"+e.id+"-view1-row-"+a,j=$(i).find("td[field='"+b+"'] div.datagrid-cell"),j.html(c).addClass("datagrid-cell-edit"),k=d.getColumnData(b,"callBack"),null!=k&&$.isFunction(k)&&k!=e.noop&&k.call(d,j,a,b,h),d.setRowData(a,g,c),d.fireEvent("onCellEdit",[j,a,b,h]),h)},getSlectRows:function(a){var e,f,g,h,b=this,c=b.configs;if(c.gid,e=[],a=$.dataGrid._undef(a,!1),$("#view2_"+c.id).find("tr.datagrid-row[datagrid-row-select='1']").each(function(){e.push($(this).attr("datagrid-row-index"))}),f=[],a){for(g=0,h=e.length;h>g;g++)f.push(c.data[e[g]]);return f}return e},onLockRow:function(){for(var a=this,b=a.configs,c=b.lockRows,d=0,e=c.length;e>d;d++)null!=c[d]&&a.lockRow(c[d])},onAfterLockRow:function(a){var e,f,g,b=this,c=b.configs,d=b.getRowData(a);$("#"+c.id+"-expand-row-"+a).size()&&(e=$("#"+c.id+"-expand-row-"+a).is(":hidden"),b.expandRow(a,d._expand),e&&b.hideExpandRow(a)),c.groupBy&&(f=$("#view2-datagrid-body-btable-tbody-"+c.id),f.find("tr.datagrid-group-row").each(function(){var b=$(this).attr("datagrid-group-row-id"),c=f.find("tr[datagrid-group-id='"+b+"']").first();$(this).insertBefore(c)}),g=$("#view1-datagrid-body-btable-tbody-"+c.id),g.find("tr.datagrid-group-row-view1").each(function(){var b=$(this).attr("datagrid-group-row-id"),c=g.find("tr[datagrid-group-id='"+b+"']").first();$(this).insertBefore(c)})),b.changeExpandPos()},onLockColumn:function(){var a=this,b=a.configs,c=b.lockColumns;setTimeout(function(){for(var b=0,d=c.length;d>b;b++)a.lockColumn(c[b])},0)},onAfterLockColumn:function(){var b=this,c=b.configs;c.gid,$("#view2_"+c.id).find("tr.datagrid-row-expand").each(function(){var d=$(this).attr("datagrid-expand-row-index"),e=$(this).is(":hidden"),f=b.getRowData(d);$("#"+c.id+"-expand-row-"+d).size()&&(b.expandRow(d,f._expand),e&&b.hideExpandRow(d))}),b.setExpandRowSize(),b.addGroupRow()},lockRow:function(a){var b=this,c=b.configs;b._lockRow(a)&&(-1==b.inArray(a,c.lockRows)&&c.lockRows.push(a),b.fireEvent("onAfterLockRow",[a]),b.fireEvent("onViewSizeChange",[]))},unLockRow:function(a){var d,e,f,g,b=this,c=b.configs;if(b._unLockRow(a)){for(d=0,e=c.lockRows.length;e>d;d++)c.lockRows[d]==a&&(c.lockRows[d]=null);for(f=[],g=0,e=c.lockRows.length;e>g;g++)null!==c.lockRows[g]&&f.push(c.lockRows[g]);c.lockRows=f,b.onAfterLockRow(a),b.fireEvent("onAfterUnLockRow",[a]),b.fireEvent("onViewSizeChange",[])}},unLockColumn:function(a){var d,e,f,g,b=this,c=b.configs;if(b._unLockColumn(a)){for(d=0,e=c.lockColumns.length;e>d;d++)c.lockColumns[d]==a&&(c.lockColumns[d]=null);for(f=[],g=0,e=c.lockColumns.length;e>g;g++)null!==c.lockColumns[g]&&f.push(c.lockColumns[g]);c.lockColumns=f,b.onAfterLockColumn(a),b.fireEvent("onAfterUnLockColumn",[a]),b.fireEvent("onViewSizeChange",[])}},lockColumn:function(a){var b=this,c=b.configs;b._lockColumn(a)&&(-1==b.inArray(a,c.lockColumns)&&c.lockColumns.push(a),b.fireEvent("onAfterLockColumn",[a]),b.fireEvent("onViewSizeChange",[]))},_lockRow:function(a){var f,g,h,b=this,c=b.configs;return c.gid,f=b.fireEvent("onBeforeLockRow",[a]),f===!1?!1:(g=$("#"+c.id+"-row-"+a),h=$("#"+c.id+"-view1-row-"+a),g.length?($("#view2-datagrid-header-outer-locktable-tbody-"+c.id).append(g),$("#view1-datagrid-header-outer-locktable-tbody-"+c.id).append(h),!0):!1)},_unLockRow:function(a){var f,g,h,j,b=this,c=b.configs;if(c.gid,f=b.fireEvent("onBeforeUnlockRow",[a]),f===!1)return!1;if(g=$("#"+c.id+"-row-"+a),h=$("#"+c.id+"-view1-row-"+a),!g.length)return!1;if(-1==b.inArray(a,c.lockRows))return!1;for(c.data,j=a-1;j>=-1&&-1!=b.inArray(j,c.lockRows);j--);return a=j,a>=0?(g.insertAfter("#"+c.id+"-row-"+a),h.insertAfter("#"+c.id+"-view1-row-"+a)):($("#view2-datagrid-body-btable-tbody-"+c.id).prepend(g),$("#view1-datagrid-body-btable-tbody-"+c.id).prepend(h)),!0},_getRowNumber:function(a){var f,g,h,i,j,b=this,c=b.configs,d=c.data;return c.gid,f=$("#"+c.id+"-view1-row-"+a),g=!1,h={},f.size()||(g=!0,i=b.getTpl("view1_row"),h={i:a,id:c.id,rowNumbersExpand:c.rowNumbersExpand?c.rowNumbersExpand:!1,data:d[a],groupBy:c.groupBy,rowNumbersWidth:c.rowNumbersWidth,opt:c},j=$(b.tpl(i,h)),b.bindRowEvent(!1,j),f=j),{isNew:g,node:f}},_lockColumn:function(a){var g,h,i,k,l,m,b=this,c=b.configs;if(c.data,c.gid,c.rowNumbersWidth===!1)return!1;if(g=b.fireEvent("onBeforeLockColumn",[a]),g===!1)return!1;for(h=b.getColumnList(),a=$.isArray(a)?a:[a],i="#view1-datagrid-header-inner-htable-tbody-"+c.id,"#view1-datagrid-header-outer-locktable-tbody-"+c.id,k=0,l=a.length;l>k;k++)null!=a[k]&&-1!=b.inArray(a[k],h)&&(m=$("#view2-datagrid-header-inner-htable-tbody-"+c.id).find(">tr.datagrid-header-row td[field='"+a[k]+"']"),$(i).find(">tr.datagrid-header-row").append(m),$("#view2-datagrid-header-outer-locktable-tbody-"+c.id).find(">tr.datagrid-row td[field='"+a[k]+"']").each(function(){var d=$(this).parent().attr("datagrid-row-index"),e=b._getRowNumber(d);e.isNew&&$("#view1-datagrid-header-outer-locktable-tbody-"+c.id).append(e.node),$(this).appendTo(e.node)}),$("#view2-datagrid-body-btable-tbody-"+c.id).find(">tr.datagrid-row td[field='"+a[k]+"']").each(function(){var d=$(this).parent().attr("datagrid-row-index"),e=b._getRowNumber(d);e.isNew&&$("#view1-datagrid-body-btable-tbody-"+c.id).append(e.node),$(this).appendTo(e.node)}),$("#view2-datagrid-footer-btable-tbody-"+c.id).find(">tr.datagrid-footer-row td[field='"+a[k]+"']").each(function(){var d=$(this).parent().attr("datagrid-row-index"),e=b._getRowNumber(d);e.isNew&&$("#view1-datagrid-footer-btable-tbody-"+c.id).append(e.node),$(this).appendTo(e.node)}));return!0},_unLockColumn:function(a){var g,h,i,j,k,o,p,q,b=this,c=b.configs,d=c.gid,f=b.fireEvent("onBeforeUnlockColumn",[a]);if(f===!1)return!1;for(g=b.getColumns(),h=!1,i=0,j=g.length;j>i;i++)if(g[i].field==a){h=!0;break}if(!h)return!1;if(-1==b.inArray(a,c.lockColumns))return!1;for(k=$("#view1-datagrid-header-inner-htable-tbody-"+c.id).find(">tr.datagrid-header-row td[field='"+a+"']"),$(d),$("#view1_"+c.id),$("#view2_"+c.id),o=i,p=0,j=g.length;j>p&&g[p].field!=a;p++);for(p-=1;p>=-1&&!(0>p)&&(q=g[p].field,-1!=b.inArray(q,c.lockColumns));p--);return o=p,0>o?k.prependTo($("#view2-datagrid-header-inner-htable-tbody-"+c.id).find(">tr.datagrid-header-row")):k.insertAfter($("#view2-datagrid-header-inner-htable-tbody-"+c.id).find(">tr.datagrid-header-row").find("td[field]").eq(o)),$("#view1-datagrid-header-outer-locktable-tbody-"+c.id).find(">tr.datagrid-row td[field='"+a+"']").each(function(){var b=$(this).parent(),d=b.attr("datagrid-row-index"),e=$("#"+c.id+"-row-"+d);
0>o?e.prepend($(this)):e.find(">td").eq(o).after($(this))}),$("#view1-datagrid-body-btable-tbody-"+c.id).find(">tr.datagrid-row td[field='"+a+"']").each(function(){var b=$(this).parent(),d=b.attr("datagrid-row-index"),e=$("#"+c.id+"-row-"+d);0>o?e.prepend($(this)):e.find(">td").eq(o).after($(this))}),$("#view1-datagrid-footer-btable-tbody-"+c.id).find(">tr.datagrid-row td[field='"+a+"']").each(function(){var b=$(this).parent(),d=b.attr("datagrid-row-index"),e=$("#"+c.id+"-row-"+d);0>o?e.prepend($(this)):e.find(">td").eq(o).after($(this))}),!0},getCheckBoxColumn:function(){var b=this,c=b.configs,d=$.extend({},c._columnMetaData);return d.field="ck",d.title=c.checkBoxTitle,d._expand='<input type="checkbox">',d.hcls="datagrid-header-check",d.bcls="datagrid-cell-check",d.width=c.checkBoxWidth,d.fitColumn=c.checkBoxFit,d.align="center",d.callBack=function(a,b){var e=this;$(a).find("input:checkbox").click(function(a){this.checked?e.selectRow(b):e.unselectRow(b),a.stopPropagation()})},d},geteditColumn:function(){var g,b=this,c=b.configs,d=$.extend({},c._columnMetaData),e=0,f=0;return $.isArray(c.editColumn)?$.each(c.editColumn,function(a){$.isPlainObject(this)?(c.editColumn[a]=$.extend({},c._toolItem,c.editColumn[a]),e++):f++}):c.editColumn=[],g="",d.field="ed",d.title=""==c.editColumnTitle||c.editColumnTitle===!1?" ":c.editColumnTitle,d._expand=g,d.hcls="datagrid-header-edit",d.bcls="datagrid-cell-edit",d.width=e*c.editCellW+4*f+"px",d.fitColumn=c.editColumnFit,d.align="center",d.callBack=function(a,b,d,e){for(var l,f=this,g=c._toolItem,h=[],i={},j=0,k=c.editColumn.length;k>j;j++)$.isPlainObject(c.editColumn[j])?(i=$.extend(!0,{},g,c.editColumn[j]),i.callBack=function(a,g){var h=$(a).attr("indexid");c.editColumn[h].callBack.call(f,a,b,d,e,g)},h.push(i)):h.push(c.editColumn[j]);l=f.getTools(h),a.append(l)},d},onInitFieldWidth:function(){var a=this;return a.configs,a._initFieldWidth(),a},onFinishFieldWidth:function(){var a=this,b=a.configs,c=b.columns;return $.each(c,function(b,c){-1!=c.width.toString().indexOf("%")&&a.setFieldWidth(c.field,c.width)}),a},_initFieldWidth:function(){var g,h,i,j,a=this,b=a.configs,c=a.getColumns(),d=0,e=$("#"+b.id).width(),f=$("#view1-datagrid-header-inner-htable-"+b.id).outerWidth();for(d=e-parseFloat(f),$("#"+b.id+"_css").remove(),g=[],g.push('<style type="text/css" id="'+b.id+'_css">'),h=0;h<c.length;h++)i=c[h].width,i=-1!=i.toString().indexOf("%")?parseFloat(i)*d/100:parseFloat(i),i-=b.padding,i=Math.floor(i),j="#"+b.id+" .datagrid-cell-"+c[h].field+"{width:"+i+"px;}",g.push(j);return g.push("</style>"),g=g.join("\n"),$("#"+b.id).before(g),a},setFieldWidth:function(a,b,c){var f,g,h,i,j,k,l,m,n,o,d=this,e=d.configs;if(c=$.dataGrid._undef(c,!1),b=$.dataGrid._undef(b,120),-1!=b.toString().indexOf("%")?(f=0,g=d.getScrollbarSize(),h=$("#view2-datagrid-body-"+e.id),f=h.outerWidth(),i=h.get(0).scrollHeight,i>h.outerHeight()&&(f-=g.width),b=parseFloat(b)*f/100):b=parseFloat(b),c||(b-=e.padding),b=Math.floor(b),j="#"+e.id+" .datagrid-cell-"+a,k=$("#"+e.id+"_css").get(0),!k)return!1;for(l=k.styleSheet?k.styleSheet:k.sheet||document.styleSheets[document.styleSheets.length-1],m=l.cssRules||l.rules,n=!1,o=0;o<m.length;o++)if(m[o].selectorText.toLowerCase()==j.toLowerCase()){m[o].style.width=b+"px",n=!0;break}return n||(l.addRule||l.insertRule,l.addRule?l.addRule(j,"width:"+b+"px"):l.insertRule(j+"{width:"+b+"px}",m.length)),d.fireEvent("onScroll",[!0]),d.setGridHeaderTextLimit(),d.setGridBodyTextLimit(a),d.fireEvent("onViewSizeChange",[]),d.setGroupRowSize(),d.setExpandRowSize(),d},getColumns:function(a){var e,f,g,h,i,j,k,b=this,c=b.configs,d=c.columns;if(a=$.dataGrid._undef(a,!1),c.cacheData.columns=$.dataGrid._undef(c.cacheData.columns,d),a)return c.cacheData.columns;if(d.length<=0&&c.data.length>0&&$.isPlainObject(c.data[0]))for(e in c.data[0])d.push({field:e});for(f=[],g=!1,h=!1,e=0,i=d.length;i>e;e++)d[e]=$.extend({},c._columnMetaData,d[e]),d[e].disabled!==!0&&(d[e].title=""==d[e].title?d[e].field:d[e].title,d[e].index=""==d[e].index?d[e].field:d[e].index,c.checkBox!==!1&&"ck"==d[e].field&&g===!1&&(d[e]=b.getCheckBoxColumn(d),g=!0),c.editColumn!==!1&&"ed"==d[e].field&&h===!1&&(d[e]=b.geteditColumn(d),h=!0),f.push(d[e]));return c.columns=d=f,j=[],k=[],c.checkBox!==!1&&g===!1&&b.getCheckBoxColumn(d)!==!1&&(j=[b.getCheckBoxColumn(d)],$.merge(j,d),d=j),c.editColumn!==!1&&h===!1&&b.geteditColumn(d)!==!1&&(k=[b.geteditColumn(d)],$.merge(d,k)),c.columns=d,c.columns},getColumnList:function(){var d,e,f,g,a=this,b=a.configs;for(b.gid,d=b.columns,e=[],f=0,g=d.length;g>f;f++)e.push(d[f].field);return e},onDisplayField:function(){var e,f,a=this,b=a.configs,c=b.hideColumns;if(b.gid,!(c.length<=0))for(e=0,f=c.length;f>e;e++)null!=c[e]&&a.hideColumn(c[e])},displayColumn:function(a,b){var h,i,j,c=this,d=c.configs,e=d.hideColumns,f=d.gid,g=c.getColumnList();if(-1==c.inArray(a,g))return!1;if(h="show"==b?!0:!1)for(i=0,j=e.length;j>i;i++)e[i]==a&&(e[i]=null);else-1==c.inArray(a,e)&&e.push(a);return $(f).find("td[field='"+a+"']")[b](),c.fireEvent("onViewSizeChange"),c.setGroupRowSize(),c.setExpandRowSize(),!0},showColumn:function(a){var b=this;return b.displayColumn(a,"show")},hideColumn:function(a){var b=this;return b.displayColumn(a,"hide")},sortColumn:function(a){var e,b=this,c=b.configs;c.gid,a=a||!1,0!=a&&(e="#view2-datagrid-header-inner-htable-tbody-"+c.id,$(e).find("td[field='"+a+"']").find("div.datagrid-cell").click(function(){var f,d=$(this).parent().attr("field");c.sortName=d,f=b.fireEvent("onSortColumn",[d]),f!==!1&&($(this).hasClass("datagrid-sort-asc")?($(e).find("div.datagrid-cell").removeClass("datagrid-sort-asc").removeClass("datagrid-sort-desc"),$(this).removeClass("datagrid-sort-asc"),$(this).addClass("datagrid-sort-desc"),c.sortOrder="desc"):($(e).find("div.datagrid-cell").removeClass("datagrid-sort-asc").removeClass("datagrid-sort-desc"),$(this).removeClass("datagrid-sort-desc"),$(this).addClass("datagrid-sort-asc"),c.sortOrder="asc"),b.refreshData())}))},showHeader:function(){var a=this,b=a.configs;b.showHeader=!0,a.fireEvent("onViewSizeChange",[])},hideHeader:function(){var a=this,b=a.configs;b.showHeader=!1,a.fireEvent("onViewSizeChange",[])},setGridHeaderEvent:function(a){var g,h,i,c=this,d=c.configs;d.gid,d.columns,d.fitColumns&&(g=$.extend({},d),g.self=c,g.stop=function(a,b){var d=c.fireEvent("onResizeColumnStop",[b]);return d===!1?d:(c.cStop(b),void 0)}),h=a.find("td[field]").each(function(){var b,e,a=$(this).attr("field");d.fitColumns&&(b=c.getColumnData(a,"fitColumn"),b&&$("div.datagrid-cell",this)._resize(g)),e=c.getColumnData(a,"sortable"),e?c.sortColumn(a):$("div.datagrid-cell >.datagrid-sort-icon",this).hide(),d.sortName&&d.sortName==a&&$("div.datagrid-cell",this).addClass("datagrid-sort-"+d.sortOrder.toLowerCase())}),d.moveColumns&&h.moveColumn(d),h.bind("click",function(){var b=$(this).attr("field");d.autoScrollToField&&c.scrollToField(b)}),h.hover(function(a){$(this).addClass("datagrid-header-over"),c.fireEvent("onColumnOver",[this,a])},function(a){$(this).removeClass("datagrid-header-over"),c.fireEvent("onColumnOut",[this,a])}),a.bind("contextmenu",function(a){var b=c.fireEvent("onHeaderContextMenu",[this,a]);return 0==b?!1:void 0}),c.setGridHeaderTextLimit(),d.checkBox&&(i=a.find("td[field='ck']"),i.find(".datagrid-sort-icon").hide(),i.find("input:checkbox").click(function(){return d.singleSelect?(this.checked=!1,!1):(this.checked?c.selectAllRows():c.unselectAllRows(),void 0)}))},setGridHeaderTextLimit:function(){var e,f,g,h,i,j,k,a=this,b=a.configs,c=b.gid,d=c;if(!b.textLimit)return!1;for(e=b.columns,f=0,g=e.length;g>f;f++)e[f].textLimit!==!1&&(h=$(d).find(".datagrid-header-row td[field='"+e[f].field+"']").find("div.datagrid-cell"),i=h.width(),j=h.css("fontSize"),k=a.getColumnData(e[f].field,"title"),k=a.textLimit(k,i,j),h.find("span").first().html(k))},setGridHeader:function(){var d,e,f,g,h,i,j,k,l,m,n,o,p,a=this,b=a.configs;return b.gid,d=a.getColumns(),e=a.getTpl("view1_header_inner_row"),f=b.headerTpl?b.headerTpl:a.getTpl("view2_header_inner_row"),g=$("#datagrid-view2-header-inner-wraper-"+b.id),h=$("#datagrid-view1-header-inner-wraper-"+b.id),i=$("#datagrid-view2-header-outer-wraper-"+b.id),j=$("#datagrid-view1-header-outer-wraper-"+b.id),k=['<table class="datagrid-htable" id="view1-datagrid-header-inner-htable-'+b.id+'" border="0" cellspacing="0" cellpadding="0"><tbody id="view1-datagrid-header-inner-htable-tbody-'+b.id+'">'],l=['<table class="datagrid-htable" id="view2-datagrid-header-inner-htable-'+b.id+'" border="0" cellspacing="0" cellpadding="0"><tbody id="view2-datagrid-header-inner-htable-tbody-'+b.id+'">'],m=['<table class="datagrid-locktable" id="view1-datagrid-header-outer-locktable-'+b.id+'" border="0" cellspacing="0" cellpadding="0"><tbody id="view1-datagrid-header-outer-locktable-tbody-'+b.id+'"></tbody></table>'],n=['<table class="datagrid-locktable" id="view2-datagrid-header-outer-locktable-'+b.id+'" border="0" cellspacing="0" cellpadding="0"><tbody id="view2-datagrid-header-outer-locktable-tbody-'+b.id+'"></tbody></table>'],o=a.tpl(e,b),p=a.tpl(f,{fields:d,opt:b}),k.push(o),l.push(p),k.push("</tbody></table>"),l.push("</tbody></table>"),h.html(k.join("")),g.html(l.join("")),j.html(m.join("")),i.html(n.join("")),a.fireEvent("onHeaderCreate",[]),o=$("> tr.datagrid-header-row","#view1-datagrid-header-inner-htable-tbody-"+b.id),p=$("> tr.datagrid-header-row","#view2-datagrid-header-inner-htable-tbody-"+b.id),a.setGridHeaderEvent(p,o),a.methodCall("setGridHeader"),!0},onHeaderCreate:function(){var fields,headerBody,_columns,_thex,self=this,opt=self.configs,gid=opt.gid;return opt.headerTpl?(fields=opt.columns,headerBody=$("#view2-datagrid-header-inner-htable-tbody-"+opt.id),_columns=[],_thex=$.dataGrid.getToGridOptions(),headerBody.find(">tr td[field],>tr th[field],>tr td["+_thex.options_from+"],>tr th["+_thex.options_from+"]").each(function(i){var _d2,_d3,j,len,_d4,$this,field=$(this).attr("field"),_d=$(this).attr(_thex.options_from);for(_d=_d?eval("({"+_d+"})"):{},field||(field=_d.field?_d.field:"field_"+Math.floor(999999*Math.random())),_d2={},_d2.title=$(this).html(),_d3={},j=0,len=fields.length;len>j;j++)if(fields[j].field==field){_d3=fields[j];break}$.isEmptyObject(_d3)&&(_d3.field=field),_d.width=_d.width?_d.width:$(this).width(),_d4=$.extend(!0,{},_d,_d2,_d3),_d4.align=_d4.align?_d4.align:$(this).attr("align")?$(this).attr("align"):opt._columnMetaData.align,_d4.hcls=_d4.hcls?_d4.hcls:opt._columnMetaData.hcls,$this=this,$(this).is("th")?($this=$('<td field="'+_d4.field+'" align="'+_d4.align+'"></td>'),$(this).replaceWith($this)):($(this).attr("field",_d4.field),$(this).attr("align",_d4.align)),$($this).html('<div class="datagrid-header-wrap" field="'+_d4.field+'"><div class="datagrid-cell datagrid-cell-'+_d4.field+" datagrid-cell-header-"+_d4.field+" "+_d4.hcls+'" ><span>'+_d4.title+'</span><span class="datagrid-sort-icon">&nbsp;</span></div></div>'),_columns.push(_d4)}),opt.columns=_columns,headerBody.find(">tr").addClass("datagrid-header-row"),headerBody.find(">tr")):-1},setColumnValue:function(a,b,c){for(var d=this,e=d.getColumns(),f=0,g=e.length;g>f;f++)e[f].field!=a||(e[f][b]=c)},cStop:function(a){var f,b=this,c=b.configs,d=c.gid,e=$(d).find("td[field='"+a.field+"']:first").find("div.datagrid-cell");e.size()&&(f=parseFloat(e.width()),f+=a.offsetX,f=10>f?10:f,f+=c.padding,b.setColumnValue(a.field,"width",f),b.setFieldWidth(a.field,f),b.fireEvent("onAfterResize",[a]))},setGroupRowSize:function(){var d,e,a=this,b=a.configs,c=b.gid;b.groupBy&&(d=c+" .datagrid-view2",e=$(d).find(".datagrid-header-row").first().width(),$(d).find(".datagrid-group-row td").width(e))},changeExpandPos:function(){var a=this,b=a.configs;b.gid,$("#view2-datagrid-body-btable-tbody-"+b.id).find(".datagrid-row-expand").each(function(){if(!$(this).is(":hidden")){var c=$(this).attr("datagrid-expand-row-index");a.expandRow(c,"")}})},setExpandRowSize:function(){var a=this,b=a.configs,c=b.gid,d=c+" .datagrid-view2";$(d).find(".datagrid-row-expand").each(function(){var c=$(this).attr("datagrid-expand-row-index"),d=$("#"+b.id+"-row-"+c),e=0;d.find(">td >.datagrid-cell").each(function(){$(this).is(":hidden")||(e+=$(this).width())}),$(this).find(".datagrid-cell-expand").width(e)})},isRowHidden:function(a){var b=this,c=b.configs;return c.gid,void 0===a?!0:$("#"+c.id+"-row-"+a).size()&&!$("#"+c.id+"-row-"+a).is(":hidden")?!1:!0},isExpandRowShow:function(a){var e,b=this,c=b.configs;return c.gid,e=c.id+"-expand-row-"+a,$("#"+e).size()&&!$("#"+e).is(":hidden")?!0:!1},expandRow:function(a,b){var g,h,i,j,k,l,m,n,o,p,q,r,s,c=this,d=c.configs;if(d.gid,d.events,a="undefined"==typeof a?!1:a,a===!1)return c;if(b="undefined"==typeof b?"":b,g=c.getRowData(a),b=c.tpl(b,g),h=$("#"+d.id+"-row-"+a),i=$("#"+d.id+"-view1-row-"+a),h.size()<=0)return c;if(j=d.id+"-expand-row-"+a,$("#"+j).size())h.after($("#"+j));else{k=0,h.find(">td >.datagrid-cell").each(function(){$(this).is(":hidden")||(k+=$(this).width())}),l=$("<tr id='"+j+"' class='datagrid-row-expand' datagrid-expand-row-index='"+a+"'><td colspan='"+d.columns.length+"'><div class=' datagrid-cell-expand' style='overflow:hidden;width:"+k+"px'></div></td></tr>");try{$(b).size()?l.find("div.datagrid-cell-expand").append($(b).show()):l.find("div.datagrid-cell-expand").html(b)}catch(f){l.find("div.datagrid-cell-expand").html(b)}h.after(l)}if(m=d.id+"-expand-view1-row-"+a,d.rowNumbersWidth!==!1||d.lockColumns.length){if($("#"+m).remove(),n=0,o="",d.lockColumns.length)for(p=0,q=d.lockColumns.length;q>p;p++)null!=d.lockColumns[p]&&n++;n&&(o='<td colspan="'+n+'" class="datagrid-cell-rownumber-expand"></td>'),r=$("<tr id='"+m+"' style='overflow:hidden;'  class='datagrid-row datagrid-row-view1' datagrid-expand-row-index='"+a+"'><td class='datagrid-td-rownumber'><div class='datagrid-cell-view1-expand'></div></td>"+o+"</tr>"),i.after(r),s=$("#"+j).height(),$("#"+m).height(s),s!=$("#"+m).height()&&(s=$("#"+m).height(),$("#"+m).height(s-1))}l=$.dataGrid._undef(l,$("#"+j)),r=$.dataGrid._undef(r,$("#"+m)),c.isRowHidden(a)?(l.hide(),r.hide()):(l.show(),r.show()),s=l.height(),r.css({height:s}),c.fireEvent("onExpandRow",[a]),c.fireEvent("onViewSizeChange",[])},hideExpandRow:function(a){var e,f,b=this,c=b.configs;return c.gid,a="undefined"==typeof a?!1:a,a===!1?b:(e=c.id+"-expand-row-"+a,f=c.id+"-expand-view1-row-"+a,$("#"+e).hide(),$("#"+f).hide(),b.fireEvent("onViewSizeChange",[]),void 0)},destroyExpandRow:function(a){var e,f,b=this,c=b.configs;return c.gid,a="undefined"==typeof a?!1:a,a===!1?b:(e=c.id+"-expand-row-"+a,f=c.id+"-expand-view1-row-"+a,$("#"+e).remove(),$("#"+f).remove(),b.fireEvent("onViewSizeChange",[]),void 0)},updateExpandRow:function(a,b){var c=this;c.destroyExpandRow(a),c.expandRow(a,b)},selectAllRows:function(){var e,f,g,a=this,b=a.configs;if(b.gid,b.events,b.singleSelect)return a;if(e=a.fireEvent("onSelectAll",[]),e===!1)return a;for(f=0,g=b.data.length;g>f;f++)a.selectRow(f);return a},unselectAllRows:function(){var e,f,g,h,a=this,b=a.configs;if(b.gid,b.events,e=a.fireEvent("onUnselectAll",[]),e===!1)return a;for(f=a.getSlectRows(),g=0,h=f.length;h>g;g++)a.unselectRow(f[g]);return a},addSelectRecode:function(){},removeSelectRecode:function(){},selectRow:function(a){var g,h,i,j,k,l,m,n,o,b=this,c=b.configs;if(c.gid,c.events,a="undefined"==typeof a?!1:a,a===!1)return b;if(g=b.getRowData(a),h=$("#"+c.id+"-row-"+a),i=$("#"+c.id+"-view1-row-"+a),j=$(h).add(i),j.size()<=0)return b;if(k=b.fireEvent("onSelect",[j,a,g]),k===!1)return k;if(h.attr("datagrid-row-select","1").addClass("datagrid-row-selected"),i.attr("datagrid-row-select","1").addClass("datagrid-row-selected"),c.checkBox&&(l=j.find("td[field='ck'] .datagrid-cell-check input:checkbox"),l.length&&(l.get(0).checked=!0)),c.singleSelect&&(m=b.getSlectRows(),n=m.length))for(o=0;n>o;o++)m[o]!=a&&b.unselectRow(m[o]);return b},unselectRow:function(a){var g,h,i,j,k,l,b=this,c=b.configs;return c.gid,c.events,a="undefined"==typeof a?!1:a,a===!1?b:(g=b.getRowData(a),h=$("#"+c.id+"-row-"+a),i=$("#"+c.id+"-view1-row-"+a),j=$(h).add(i),j.size()<=0?b:(k=b.fireEvent("onUnselect",[j,a,g]),k===!1?k:(h.attr("datagrid-row-select","0").removeClass("datagrid-row-selected"),i.attr("datagrid-row-select","0").removeClass("datagrid-row-selected"),c.checkBox&&(l=j.find("td[field='ck'] .datagrid-cell-check input:checkbox"),l.length&&(l.get(0).checked=!1)),b)))},showGroup:function(a,b){var h,i,c=this,d=c.configs,e=d.gid,f=e+" .datagrid-view2",g=e+" .datagrid-view1";return b=$.dataGrid._undef(b,"show"),"undefined"==typeof a?c:(h=$(f).find("tr[datagrid-group-id='"+a+"']"),i=$(g).find("tr[datagrid-group-id='"+a+"']"),h[b](),i[b](),h.each(function(){var d=$(this).attr("datagrid-row-index"),e=c.getRowData(d);e._openExpand=$.dataGrid._undef(e._openExpand,!1),e._openExpand&&c.expandRow(d,e._expand),"hide"==b&&c.hideExpandRow(d)}),"show"==b?($(f).find("#"+d.id+"-group-row-"+a).find("div.datagrid-group-cell").addClass("datagrid-group-cell-select"),$(g).find("#"+d.id+"-group-view1-row-"+a).find("div.datagrid-group-cell-rownumber").addClass("datagrid-group-cell-rownumber-select")):($(f).find("#"+d.id+"-group-row-"+a).find("div.datagrid-group-cell").removeClass("datagrid-group-cell-select"),$(g).find("#"+d.id+"-group-view1-row-"+a).find("div.datagrid-group-cell-rownumber").removeClass("datagrid-group-cell-rownumber-select")),c.fireEvent("onScroll",[!0]),c.fireEvent("onViewSizeChange",[]),c)},hideGroup:function(a){var b=this;return b.showGroup(a,"hide")},addGroupRow:function(a){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,b=this,c=b.configs,d=c.gid,e=d+" .datagrid-view2",f=d+" .datagrid-view1";if(!c.groupBy)return!1;for(a=$.dataGrid._undef(a,!1),a&&($("#view2-datagrid-body-btable-tbody-"+c.id).find("> tr").hide(),$("#view1-datagrid-body-btable-tbody-"+c.id).find("> tr").hide()),g=$(e).find(".datagrid-header-row").width(),h="",c.rowNumbersWidth!==!1&&(h="datagrid-group-cell-rownumber"),i=c.lockColumns,j=0,k=0,l=i.length;l>k;k++)null!=i[k]&&j++;for(k=0,l=c.groupList.length;l>k;k++){if(c._groupListData[k]=$.dataGrid._undef(c._groupListData[k],[]),m=b.tpl(b.getTpl("group_row"),{gid:k,w:parseFloat(g),id:c.id,colspan:c.columns.length-j,html:c.groupList[k],num:c._groupListData[k].length}),n=$(e).find(".datagrid-body tr[datagrid-group-id='"+k+"']"),n.size()<=0&&(n=$(e).find(".datagrid-header .datagrid-header-outer .datagrid-locktable tr[datagrid-group-id='"+k+"']")),o=$(f).find("tr[datagrid-group-id='"+k+"']"),p="<tr id='"+c.id+"-group-view1-row-"+k+"' datagrid-group-row-id='"+k+"' class='datagrid-group-row-view1'><td colspan='"+(j+1)+"'><div class='"+h+"'></div></td></tr>",q=$(m),r=$(p),$("#"+c.id+"-group-row-"+k).size())$("#"+c.id+"-group-row-"+k).replaceWith(q),$("#"+c.id+"-group-view1-row-"+k).replaceWith(r),n.first().is(":hidden")||r.find("div.datagrid-group-cell-rownumber").addClass("datagrid-group-cell-rownumber-select");else if(n.size())q.insertBefore(n.first()),r.insertBefore(o.first()),n.first().is(":hidden")||r.find("div.datagrid-group-cell-rownumber").addClass("datagrid-group-cell-rownumber-select");else{for(s=k-1;s>=0;s--)if(t=$(e).find("tr[datagrid-group-id='"+k+"']"),u=$(f).find("tr[datagrid-group-id='"+k+"']"),t.size()){q.insertAfter(t.last()),r.insertAfter(u.first());break}0>s&&(q.appendTo($(e).find(".datagrid-body .datagrid-btable tbody")),r.appendTo($(f).find(".datagrid-body .datagrid-btable tbody")))}v=q.height(),r.height(v),v!=r.height()&&r.height(v-1),c.groupListCallBack.call(b,q.find(".datagrid-group-cell"),c.groupList[k],c._groupListData[k])}b.setGroupEvent()},setGroupEvent:function(){for(var a=this,b=a.configs,c=b.gid,d=c+" .datagrid-view2",e=c+" .datagrid-view1",f=0,g=b.groupList.length;g>f;f++)$(d).find("#"+b.id+"-group-row-"+f).click(function(){var b=$(this).attr("datagrid-group-row-id"),c=$(this).find(".datagrid-group-cell");c.hasClass("datagrid-group-cell-select")?a.hideGroup(b):a.showGroup(b)}),$(e).find("#"+b.id+"-group-view1-row-"+f).click(function(){var b=$(this).attr("datagrid-group-row-id"),c=$(this).find(".datagrid-group-cell-rownumber");c.hasClass("datagrid-group-cell-rownumber-select")?a.hideGroup(b):a.showGroup(b)})},groupByField:function(a,b,c){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,d=this,e=d.configs;if(e.gid,a=$.dataGrid._undef(a,e.groupBy),b=$.dataGrid._undef(b,e.data),c=$.dataGrid._undef(c,e.groupList),e._groupList=$.dataGrid._undef(e._groupList,e.groupList),a===!1)return d;for(g=e.columns,h=!1,i=!1,j=0;j<g.length;j++)if(g[j].field==a){i=a,h=g[j].index;break}if(i===!1)return e.groupBy=i,d;if(a=i,e.groupBy=a,k=[],e._groupList===!1)for(c=[],l=b.length,j=0;l>j;j++)-1===d.inArray(b[j][h],c)&&c.push(b[j][h]);for(e.groupList=c,m=c.length,n=b.length,o=0;m>o;o++){for(p=[],q=0;n>q;q++)b[q][h]==c[o]&&(b[q]._groupid_=o,p.push(b[q]));k[o]=p,p=[]}for(e._groupListData=k,b=[],r=0,s=k.length;s>r;r++)for(t=k[r].length,u=0;t>u;u++)b.push(k[r][u]);return e.data=b,d},searchData:function(a,b,c,d){var h,i,j,k,l,m,n,o,p,e=this,f=e.configs;if(f.gid,a=$.dataGrid._undef(a,null),null==a)return e;if(e.clearSearch(!1),b=$.dataGrid._undef(b,!1),h=b,i=f.columns,b!==!1){for(j=!1,k=i.length,l=0;k>l;l++)if(i[l].field==b){j=b,h=i[l].index;break}b=j}if("undefined"==typeof c&&(c=e.getAsync()),f.cacheData.searchAsync=c,d=$.dataGrid._undef(d,f.cacheData.searchData||f.cacheData.source||f.data),f.cacheData.searchData=f.cacheData.searchData||d,c){for(1!=f.cacheData.searched&&(f.cacheData._url=f.url,f.cacheData._pageNumber=f.pageNumber,f.cacheData._data=f.data,f.url="",f.pageNumber=1),m=[],n=d.length,l=0;n>l;l++)if(b!==!1)-1!=d[l][h].toString().indexOf(a)&&m.push(d[l]);else for(o=i.length,p=0;o>p;p++)if(h=i[p].index,-1!=d[l][i[p].index].toString().indexOf(a)){m.push(d[l]);break}e.setGridData(m,!0),e.showGrid(function(){e.fireEvent("onSearch",[m]),e.setGridBody()},$.noop,!0)}else 1!=f.cacheData.searched&&(f.cacheData._pageNumber=f.pageNumber,f.pageNumber=1),f.queryParams.searchText=a,f.queryParams.searchField=h,e.showGrid(function(){e.fireEvent("onSearch",[f.data]),e.setGridBody()});return f.cacheData.searched=!0,e},clearSearch:function(a){var b=this,c=b.configs;if(c.gid,c.cacheData.searched!==!0)return b;a=$.dataGrid._undef(a,!0),c.cacheData.searched=!1,b.setGridData(c.cacheData.searchData),c.url=c.cacheData._url||c.url,c.pageNumber=c.cacheData._pageNumber||c.pageNumber,c.data=c.cacheData._data||c.data;try{delete c.cacheData._url}catch(e){}try{delete c.cacheData._pageNumber}catch(e){}try{delete c.cacheData.searchData}catch(e){}try{delete c.cacheData._data}catch(e){}try{delete c.queryParams.searchText}catch(e){}try{delete c.queryParams.searchField}catch(e){}return c.cacheData.searchAsync||delete c.cacheData.source,a&&(c.cacheData.searchAsync?b.refreshDataCache():b.refreshData()),delete c.cacheData.searchAsync,b},onOverRow:function(a){var b=this,c=b.configs;c.gid,$("#"+c.id+"-view1-row-"+a).addClass("datagrid-row-over"),$("#"+c.id+"-row-"+a).addClass("datagrid-row-over")},onOutRow:function(a){var b=this,c=b.configs;c.gid,$("#"+c.id+"-view1-row-"+a).removeClass("datagrid-row-over"),$("#"+c.id+"-row-"+a).removeClass("datagrid-row-over")},setGridBodyTextLimit:function(a,b){var g,h,i,j,k,n,o,p,q,r,s,t,c=this,d=c.configs,e=d.gid,f=e;if(!d.textLimit)return!1;if("undefined"==typeof a)for(b=d.data,g=d.columns,h=0,i=g.length;i>h;h++)g[h].textLimit!==!1&&(j=$(f).find(".datagrid-view2 .datagrid-body td[field='"+g[h].field+"']"),j.each(function(){var f,i,j,b=$(this).parent().attr("datagrid-row-index"),d=c.getRowData(b),e=$(this).find("div.datagrid-cell").html();"undefined"==typeof d[g[h].index]&&c.setRowData(b,g[h].index,e),e=d[g[h].index],f=$(this).find("div.datagrid-cell").width(),i=$(this).find("div.datagrid-cell").css("fontSize"),j=e,j=c.textLimit(j,f,i),$(this).find("div.datagrid-cell").html(j)}));else if(2==arguments.length)for(k=a,g=d.columns,k.attr("datagrid-row-index"),b=b,n="",h=0,i=g.length;i>h;h++)g[h].textLimit!==!1&&(n=$.dataGrid._undef(b[g[h].index],""),""!=n&&(o=k.find("td[field='"+g[h].field+"'] div.datagrid-cell"),p=o.width(),q=o.css("fontSize"),r=n,r=c.textLimit(r,p,q),o.html(r)));else s=c.getColumnData(a,"textLimit"),s&&(j=$(f).find("tr.datagrid-row td[field='"+a+"']"),t=c.getColumnData(a,"index"),j.each(function(){var f,g,h,b=$(this).parent().attr("datagrid-row-index"),d=c.getRowData(b),e=$(this).find("div.datagrid-cell").html();"undefined"==typeof d[t]&&c.setRowData(b,t,e),e=d[t],f=$(this).find("div.datagrid-cell").width(),g=$(this).find("div.datagrid-cell").css("fontSize"),h=e,h=c.textLimit(h,f,g),$(this).find("div.datagrid-cell").html(h)}))},bindRowEvent:function(a,b){var h,i,j,c=this,d=c.configs;d.data,d.gid,"undefined"==typeof a&&(a=!1),"undefined"==typeof b&&(b=!1),h=d.columns,i={click:function(a){var f,g,h,i,b=$(this).attr("datagrid-row-index"),e=c.getRowData(b);return d.autoScrollToRow&&c.scrollToRow(b),f=c.cellEvents(b,a),f===!1?!1:(g=c.fireEvent("onClickRow",[this,b,e,a]),g===!1?!1:(h=$(this).attr("datagrid-row-select"),i=c.getSlectRows(),"1"==h?d.singleSelect?1==i.length&&i[0]!=b&&c.unselectRow(b):c.unselectRow(b):c.selectRow(b),void 0))},mouseover:function(a){var b=$(this).attr("datagrid-row-index"),d=c.cellEvents(b,a);return d===!1?!1:(c.fireEvent("onOverRow",[b,a]),void 0)},mouseout:function(a){var b=$(this).attr("datagrid-row-index"),d=c.cellEvents(b,a);return d===!1?!1:(c.fireEvent("onOutRow",[b,a]),void 0)},dblclick:function(a){var f,b=$(this).attr("datagrid-row-index"),d=c.getRowData(b),e=c.cellEvents(b,a);return e===!1?!1:(f=c.fireEvent("onDblClickRow",[this,b,d,a]),0==f?!1:void 0)},contextmenu:function(a){var g,b=$(this).attr("datagrid-row-index"),d=c.getRowData(b),f=c.cellEvents(b,e);return f===!1?!1:(g=c.fireEvent("onRowContextMenu",[this,b,d,a]),0==g?!1:void 0)}},a&&(a.bind(i),a.each(function(){var f,g,i,j,k,a=$(this),b=$(this).attr("datagrid-row-index"),e=c.getRowData(b);for($.isFunction(d.rowCallBack)&&d.rowCallBack!=$.noop&&d.rowCallBack.call(c,a,b,e),d.rowStyler&&($.isFunction(d.rowStyler)?(f=d.rowStyler.call(c,a,b,e),"string"==typeof f&&a.addClass(f)):"string"==typeof d.rowStyler&&a.addClass(d.rowStyler)),g=[],i=0,j=h.length;j>i;i++)g=h[i],$.isFunction(g.callBack)&&g.callBack!=d.noop&&(k=$("#"+d.id+"_"+g.field+"_row_"+b+"_cell"),g.callBack.call(c,k,b,g,e));c.setGridBodyTextLimit(a,e)})),b&&(j={click:function(a){var g,b=$(this).attr("datagrid-row-index"),e=b;return a.srcElement?a.srcElement:a.target,g=c.cellEvents(b,a),g===!1?!1:(c.fireEvent("onClickRowNumber",[e,a]),d.rowNumbers2Row!==!1&&$("#"+d.id+"-row-"+e).trigger("click"),void 0)},mouseover:function(a){var b=$(this).attr("datagrid-row-index"),d=c.cellEvents(b,a);return d===!1?!1:(c.fireEvent("onOverRow",[b,a]),void 0)},mouseout:function(a){var b=$(this).attr("datagrid-row-index"),d=c.cellEvents(b,a);return d===!1?!1:(c.fireEvent("onOutRow",[b,a]),void 0)},dblclick:function(a){var b=c.cellEvents(rowId,a);return b===!1?!1:(d.rowNumbers2Row!==!1&&$("#"+d.id+"-row-"+rid).trigger("dblclick"),void 0)},contextmenu:function(){}},b.bind(j))},isCell:function(a){if(!$(a).length)return!1;if($(a).is("td")&&$(a).hasClass("datagrid-td-rownumber"))return!1;if($(a).is("tr")&&$(a).hasClass("datagrid-row"))return!1;if(!$(a).hasClass("datagrid-cell")){var b=$(a).closest("tr.datagrid-row div.datagrid-cell");if(!b.length)return!1}return!0},cellEvents:function(a,b){var f,g,h,i,c=this,d=c.configs,e=b.srcElement?b.srcElement:b.target;if(!c.isCell(e))return!0;switch(f=$(e),g=f.parent("td").attr("field"),h=c.getFieldValue(a,g),i=!0,b.type){case"click":d.autoScrollToField&&c.scrollToField(g),i=c.fireEvent("onClickCell",[f.eq(0),a,g,h,b]);break;case"dblclick":i=c.fireEvent("onDblClickCell",[f.eq(0),a,g,h,b]);break;case"mouseover":i=c.fireEvent("onOverCell",[f.eq(0),a,g,h,b]);break;case"mouseout":i=c.fireEvent("onOutCell",[f.eq(0),a,g,h,b]);break;case"contextmenu":i=c.fireEvent("onCellContextMenu",[f.eq(0),a,g,h,b])}return i},addRow:function(){},setRow:function(a,b){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,c=this,d=c.configs,e=d.data;for(d.gid,g=d.columns,h=c.getTpl("view1_row"),i=d.rowTpl?d.rowTpl:c.getTpl("view2_row"),j={},k=$("#view2-datagrid-body-"+d.id),l=$("#view1-datagrid-body-"+d.id),b=$.dataGrid._undef(b,$.noop),a=$.dataGrid._undef(a,0),m=d._lSize,n=1,o=['<table class="datagrid-btable" id="view1-datagrid-body-btable-'+d.id+'" cellspacing="0" cellpadding="0" border="0"><tbody id="view1-datagrid-body-btable-tbody-'+d.id+'">'],p=['<table class="datagrid-btable" id="view2-datagrid-body-btable-'+d.id+'" cellspacing="0" cellpadding="0" border="0"><tbody id="view2-datagrid-body-btable-tbody-'+d.id+'">'],q=[],$.isArray(e)||(e=[]),r=e.length,s=a;r>s;s++){if(m>0){if(n>m)break;n++,d._lStart=n}q.push(s),j={i:s,id:d.id,fields:g,rowNumbersExpand:d.rowNumbersExpand?d.rowNumbersExpand:!1,data:e[s],isCreate:d.isCreate,groupBy:d.groupBy,rowNumbersWidth:d.rowNumbersWidth,opt:d},t=c.tpl(i,j),p.push(t),u=!1,d.rowNumbersWidth!==!1&&(u=c.tpl(h,j),o.push(u))}p.push("</tbody></table>"),o.push("</tbody></table>"),k.html(p.join("")),l.html(o.join("")),t=!1,u=!1,d.rowTpl?(t=$(">tr","#view2-datagrid-body-btable-tbody-"+d.id),t.each(function(a){var b=$(this),c=q[a],f=c;b.find(">td,>th").each(function(a){var b=d.id+"_"+g[a].field+"_row_"+c+"_td",e=d.id+"_"+g[a].field+"_row_"+c+"_cell",f=this;$(this).is("th")?(f=$("<td id='"+b+"' field='"+g[a].field+"' align='"+g[a].align+"'><div  id='"+e+"'  class='datagrid-cell datagrid-cell-"+g[a].field+" datagrid-cell-c1-"+g[a].field+" ' >"+$(this).html()+"</div></td>"),$(this).replaceWith(f)):$(this).attr("field",g[a].field).attr("align",g[a].align).attr("id",b).html("<div  id='"+e+"' class='datagrid-cell datagrid-cell-"+g[a].field+" datagrid-cell-c1-"+g[a].field+" ' >"+$(this).html()+"</div>")}),b.addClass("datagrid-row").attr("id",d.id+"-row-"+f).attr("datagrid-row-index",f).attr("datagrid-row-select",0),"undefined"!=typeof e[f]._groupid_&&b.attr("datagrid-group-id",e[f]._groupid_)})):t=$(">tr.datagrid-row","#view2-datagrid-body-btable-tbody-"+d.id),d.rowNumbersWidth!==!1&&(u=$(">tr.datagrid-row","#view1-datagrid-body-btable-tbody-"+d.id)),d.denyRowEvents===!1?c.bindRowEvent(t,u):$.isFunction(d.denyRowEvents)&&d.denyRowEvents.call(c,t,u),b(),c.afterGridShow()},view2_row:function(a){var b,c,f,g,h,i,j,k,l,m,n,o;if(!a)return"";for(b=this,c=b.configs,c.data,c.gid,f=[],"undefined"!=typeof a.data._groupid_&&(f.push("datagrid-group-id="),f.push(a.data._groupid_)),f=f.join(""),g=(a.i+1)%2?"datagrid-row-single":"datagrid-row-double",h=[],h.push('<tr id="'),h.push(a.id),h.push("-row-"),h.push(a.i),h.push('" '),h.push(f),h.push(' datagrid-row-index="'),h.push(a.i),h.push('" datagrid-row-select="0" class="datagrid-row '),h.push(g),h.push('">'),i=0,j=a.fields.length;j>i;i++)k=[],k.push(c.id),k.push("_"),k.push(a.fields[i].field),k.push("_row_"),k.push(a.i),k.push("_td"),k=k.join(""),l=[],l.push(c.id),l.push("_"),l.push(a.fields[i].field),l.push("_row_"),l.push(a.i),l.push("_cell"),l=l.join(""),m=a.fields[i].field,n=a.fields[i].index,o=a.fields[i]._expand!==!1?c.self.tpl(a.fields[i]._expand,a.data):a.data[n],h.push('<td field="'),h.push(m),h.push('" id="'),h.push(k),h.push('" align="'),h.push(a.fields[i].align),h.push('">'),h.push('<div id="'),h.push(l),h.push('" class="datagrid-cell datagrid-cell-'),h.push(m),h.push(" datagrid-cell-c1-"),h.push(m),h.push(" "),h.push(a.fields[i].bcls),h.push('" >'),h.push(o),h.push("</div></td>");return h.push("</tr>"),h.join("")},view1_row:function(a){var b,c,f,g,h,i,j,k;return a?(b=this,c=b.configs,c.data,c.gid,f=[],"undefined"!=typeof a.data._groupid_&&(f.push("datagrid-group-id="),f.push(a.data._groupid_)),f=f.join(""),g=(a.i+1)%2?"datagrid-row-single":"datagrid-row-double",h=[],h.push(c.id),h.push("_row_"),h.push(a.i),h.push("_td_rownumber"),h=h.join(""),i=[],i.push(c.id),i.push("_row_"),i.push(a.i),i.push("_cell_rownumber"),i=i.join(""),j=[],j.push('<tr id="'),j.push(a.id),j.push("-view1-row-"),j.push(a.i),j.push('" '),j.push(f),j.push(' datagrid-row-index="'),j.push(a.i),j.push('" datagrid-row-select="0" class="datagrid-row datagrid-row-view1 '),j.push(g),j.push('">'),j.push('<td id="'),j.push(h),j.push('" align="center" class="datagrid-td-rownumber"><div id="'),j.push(i),j.push('" class="datagrid-cell-rownumber" style="width:'),j.push(parseFloat(a.rowNumbersWidth)),j.push('px;">'),k="",k=a.rowNumbersExpand===!1?(c.pageNumber-1)*c.pageSize+ ++a.i:"auto"==a.rowNumbersExpand?++a.i:$.isFunction(a.rowNumbersExpand)?a.rowNumbersExpand.call(b,a.data):c.self.tpl(a.rowNumbersExpand,a.data),j.push(k),j.push("</div></td>"),j.push("</tr>"),j.join("")):""
},resetHeader:function(){var d,e,a=this,b=a.configs;if(b.gid,b.lockColumns.length)for(d=0,e=b.lockColumns.length;e>d;d++)if(null!=b.lockColumns[d])return a.setGridHeader(),void 0;if(b.lockRows.length)for(d=0,e=b.lockRows.length;e>d;d++)if(null!=b.lockRows[d])return a.setGridHeader(),void 0},setGridBody:function(a,b){var c=this,d=c.configs;return d.gid,c.showLoading(),c.getColumns(),b=b||$.noop,c.fireEvent("onBeforeShowGrid",[]),setTimeout(function(){var e,f;c.groupByField(),d.data,c.setPager(),e=d.sLeft,f=d.sTop,c.setRow(0,function(){b(),d.sLeft=e,d.sTop=f}),c.hideLoading()},0),!0},afterGridShow:function(){var a=this,b=a.configs;b.gid,a.addGroupRow(!0),a.fireEvent("onScroll",[!0]),a.methodCall("setGridBody"),a.fireEvent("onViewSizeChange",[]),a.fireEvent("onShowGrid",[]),a.onFinishDone=a.onFinishDone||!1,a.onFinishDone||(a.onFinishDone=!0,a.fireEvent("onFinish"))},isEmptyGrid:function(){var d,e,f,a=this,b=a.configs;if(b.gid,b.showEmptyGridMsg&&(b.showHeader||$("#"+b.id+"_empty-grid-msg").remove(),!(b.data.length>=1)&&b.showHeader)){if(d=$("#view2-datagrid-header-inner-htable-"+b.id).outerWidth(),e=$("#"+b.id+"_empty-grid-msg"),e.size())return e.width(d),void 0;f=$('<div class="empty-grid-msg" id="'+b.id+'_empty-grid-msg" style="height:100%;">'+a.tpl(b.emptyGridMsg,b)+"</div>").width(d),$("#view2-datagrid-body-"+b.id).empty().append(f)}},setGridFooter:function(){var a=this,b=a.configs;return b.gid,!0},onScroll:function(a){var b=this,c=b.configs;c.gid,a=$.dataGrid._undef(a,!1),a&&(c.sLeft>=0&&c.gbody.scrollLeft(c.sLeft),c.sTop>=0&&c.gbody.scrollTop(c.sTop)),a||(c.sLeft=c.gbody._scrollLeft(),c.sTop=c.gbody._scrollTop()),$("#view2-datagrid-header-inner-"+c.id).find(">.datagrid-header-inner-wraper")._scrollLeft(c.sLeft),$("#view2-datagrid-header-outer-"+c.id).find(">.datagrid-header-outer-wraper")._scrollLeft(c.sLeft),$("#view1-datagrid-body-"+c.id)._scrollTop(c.sTop)},showGrid:function(a,b,c){var d=this,e=d.configs;e.gid,a=a||$.noop,b=b||$.noop,c=$.dataGrid._undef(c,!1),d.getGridData(function(){d.fireEvent("onGetData",[e.data]),a.apply(this,arguments)},function(){b.apply(this,arguments)},c)},refreshData:function(){var b,c,d,e;this.configs.events,b=this,c=b.configs,d=c.gid,e=e||d+" .datagrid-view2",b.fireEvent("onBeforeRefresh"),b.showGrid(function(){b.setGridBody(e,function(){b.fireEvent("onRefresh")})})},updateGrid:function(a){var b=this;b.configs,b.setGridData(a,!1,!0)},refreshDataCache:function(){var a=this;a.setGridBody()},clearCache:function(){var a=this.configs;a.views=[],a.isCreate=!1,this.onFinishDone=!1,a.isShow=!1,a.pki=0},clearDataCache:function(){var a=this.configs;return a.cacheData=[],this},reLoadGrid:function(a){var c,d;this.clearCache(),this.clearDataCache(),c=[],a.data&&(c=a.data,a.data=[]),d=$.extend(!0,{},a),d.data=c,$.dataGrid.call(this,d)},setWH:function(a,b){var c=this;return c.fireEvent("onSizeChange",[a,b]),c},C:function(a,b){return"undefined"==typeof a?this.configs:"undefined"==typeof b?this.configs[a]:(this.configs[a]=b,this)},createGrid:function(a){var b=this,c=b.configs,d=c.gid;return a=a||d+" .datagrid-view2",b.setGridHeader(a),b.showGrid(function(){b.setGridBody(a)}),b.setGridFooter(a),b.methodCall("createGrid"),b},sortData:function(a,b,c){var g,h,i,j,k,d=this,e=d.configs;if(e.gid,a=$.dataGrid._undef(a,e.sortName),""==a)return d;for(g=e.columns,h=!1,i=!1,j=0;j<g.length;j++)if(g[j].field==a){h=a,i=g[j].index;break}return h===!1?d:(e.cacheData.source=e.cacheData.source||e.data,b=$.dataGrid._undef(b,e.cacheData.source),c=$.dataGrid._undef(c,e.sortOrder),k="asc"==c?!0:!1,b.sort(function(a,b){return a[i]=$.dataGrid._undef(a[i],""),b[i]=$.dataGrid._undef(b[i],""),a[i]>=b[i]?k?1:-1:k?-1:1}),b)},onDataChange:function(){var b=this;b.configs,b.refreshData()},addData:function(a){var f,g,h,i,b=this,c=b.configs,d=b.getAsync(),e=$.dataGrid._undef(e,[]);if(e=$.isPlainObject(e)?[e]:e,f=c.pk,d){for(g=b.getData(),h=e.length,i=0;h>i;i++)a=e[i],a[f]=$.dataGrid._undef(a[f],b.unique()),g.push(a);b.fireEvent("onAdd",[e,!0]),b.fireEvent("onDataChange",b,[e])}else b.fireEvent("onAjaxAdd",[e,function(){b.onDataChange(e)}])},updateData:function(a){var e,f,g,h,i,j,k,l,b=this,c=b.configs,d=b.getAsync();if(a=$.dataGrid._undef(a,[]),a=$.isPlainObject(a)?[a]:a,e=c.pk,f=!1,d){for(g=a.length,h=0;g>h;h++)if(i=a[h],$.isPlainObject(i)&&(f=$.dataGrid._undef(i[e],!1),f!==!1))for(j=b.getData(),k=0,l=j.length;l>k;k++)if(j[k][e]==i[e]){j[k]=i;break}b.fireEvent("onUpdate",[a,!0]),b.fireEvent("onDataChange",[a])}else b.fireEvent("onAjaxUpdate",[a,function(){b.onDataChange(a)}])},deleteData:function(a){var e,f,g,h,i,j,k,l,m,b=this,c=b.configs,d=b.getAsync();if(a=$.dataGrid._undef(a,[]),a=$.isPlainObject(a)?[a]:a,e=c.pk,f=!1,d){for(g=b.getData(),h=a.length,i=0;h>i;i++)if(j=a[i],$.isPlainObject(j)&&(f=$.dataGrid._undef(j[e],!1),f!==!1)){for(k=0,h=g.length;h>k&&g[k][e]!=j[e];k++);for(l=0,m=[];h>l;l++)k!=l&&m.push(g[l]);g=m}b.fireEvent("onDelete",[a,!0]),b.fireEvent("onDataChange",[a])}else b.fireEvent("onAjaxDelete",[a,function(){b.onDataChange(a)}])},getAsync:function(){var a=this,b=a.configs;return b.gid,""==b.url||b.url===!1?!0:!1},setGridData:function(a,b,c){var d=this,e=d.configs;e.gid,b=$.dataGrid._undef(b,null),c=$.dataGrid._undef(c,!1),null==b&&(b=d.getAsync()),b?e.cacheData.source=a:e.data=a,"_pk"==e.pk&&(e.pk="",d.fireEvent("onSetPk",[a])),c&&(b?d.showGrid(function(){d.setGridBody()},$.noop,!0):d.refreshDataCache())},jsonFilter:function(a){return a},metaData:function(a,b){var c=this,d=c.configs,e=a||{};b=$.dataGrid._undef(b,!1),e.rows=e.rows||[],d.data=e.rows,d.total=e.total||e.rows.length,d.pageSize=c.isNumber(e.pageSize)?e.pageSize:d.pageSize,d.pageNumber=c.isNumber(e.pageNumber)?e.pageNumber:d.pageNumber,e.columns&&(d.columns=e.columns,c.setGridHeader()),b&&c.refreshDataCache()},onLoadSuccess:function(a){var f,g,c=this,d=c.configs;d.gid,f=d.dataType.toLowerCase(),g=f+"Filter",a=a,g in c&&$.isFunction(c[g])&&(a=c[g].call(c,a)),c.metaData(a)},onLoadError:function(a){var d=this,e=d.configs;e.gid,d.showLoading(a),setTimeout(function(){d.hideLoading(),d.refreshDataCache()},2e3)},getGridData:function(a,b,c){var g,h,i,j,k,l,m,n,d=this,e=d.configs,f=e.gid;if(a=a||$.noop,b=b||$.noop,g=f+" .datagrid-view2",c=$.dataGrid._undef(c,!1),0==c&&(c=d.getAsync()),d.methodCall("getGridData"),c){for(e.cacheData.source=e.cacheData.source||e.data,d.fireEvent("onSetPk",[e.cacheData.source]),""!=e.sortName&&(e.cacheData.source=d.sortData()),e.total=e.cacheData.source.length,h=(e.pageNumber-1)*e.pageSize,i=e.pageSize*e.pageNumber,i=i>e.total?e.total:i,j=[],k=h;i>k;k++)e.cacheData.source[k]&&j.push(e.cacheData.source[k]);return e.data=j,a.call(d,g),void 0}e.queryParams.pageNumber=e.pageNumber,e.queryParams.pageSize=e.pageSize,""!=e.sortName&&(e.queryParams.sortName=d.getColumnData(e.sortName,"index"),e.queryParams.sortOrder=e.sortOrder),l=function(){d.fireEvent("onBeforeLoad",[e.queryParams]),d.showLoading()},m=function(b){d.hideLoading(),d.fireEvent("onLoadSuccess",[b,a]),a.call(d,g)},n=function(a){var a=$.isPlainObject(a)?a:{responseText:a};d.fireEvent("onLoadError",[a.responseText,b,a]),b.call(d,a.responseText)},$.isFunction(e.url)?(l(),e.url.call(d,e.queryParams,m,n)):$.ajax({url:e.url,type:e.method,cache:e.cache,dataType:e.dataType,data:e.queryParams,beforeSend:l,success:m,error:n})},setPk:function(a){var b=this,c=b.configs;""==c.pk&&(c.pki=1,c.pk="_pk",$.each(a,function(b){a[b][c.pk]=c.pki++}))},show:function(){var e,a=this,b=a.configs,c=b.views,d=$("#"+b.id);if(!b.isShow){b.isShow=!0;for(e in c)d.append(c[e]);a.setGrid(),a.setView(),a.fireEvent("onViewCreate",[]),a.createGrid(),a.methodCall("show")}}}),$.fn._scrollLeft=function(a){return void 0==a?this.scrollLeft():this.each(function(){$(this).css("marginLeft",-1*a)})},$.fn._scrollTop=function(a){return void 0==a?this.scrollTop():this.each(function(){$(this).css("marginTop",-1*a)})},$.fn.datagrid=function(a){var b,c;return this.size()<=0?!1:(b=[],c=[],a.data&&(c=a.data,a.data=[]),this.each(function(){var g,e=$(this),f=$.extend(!0,{},a);f.selector=e.selector,f.helper=e,f.width=$.dataGrid._undef(f.width,e.width()),f.height=$.dataGrid._undef(f.height,e.height()),e.data("metaData",$.extend(!0,{},f,{})),a.data&&(f.data=c),g=new $.dataGrid(f),e.data("datagrid",g),b.push(g)}),1==this.size()?this.data("datagrid"):b)},$.fn.dataGrid=$.fn.datagrid,$.fn.extGrid=$.fn.datagrid,$.fn.extgrid=$.fn.datagrid,$.fn.togrid=function(cfg,_cfg){var list;return cfg=$.dataGrid._undef(cfg,{}),_cfg=$.dataGrid.getToGridOptions(_cfg),list=[],this.each(function(i){var opt,wh,columns,thead,avg_w,data,grid;$(this).css("display","block"),$(this).attr(_cfg.options_from)?(opt="{"+$(this).attr(_cfg.options_from)+"}",opt=eval("("+opt+")")):opt={},wh={width:$(this).outerWidth(),height:$(this).outerHeight(),title:$(this).attr("title")},columns=[],$(this).find(_cfg.columns_from).size()||(_cfg.columns_from="tr:first-child td,tr:first-child th"),thead=$(this).find(_cfg.columns_from),avg_w=0,(cfg.border!==!1||opt.border!==!1)&&(avg_w=2/thead.size()),thead.each(function(i){var column_a,column_b,column;void 0==$(this).attr("ignore")&&(column_a=$(this).attr("field")?{field:$(this).attr("field")}:{},$(this).attr(_cfg.options_from)?(column_b="{"+$(this).attr(_cfg.options_from)+"}",column_b=eval("("+column_b+")")):column_b={},column=$.extend({},column_b,column_a),column.title=$(this).html(),column.field=column.field?column.field:"field_"+Math.floor(999999*Math.random()),column.width=column.width?column.width:$(this).outerWidth()-1-1,$(this).attr("align")&&(column.align=$(this).attr("align")),"ck"==column.field&&(opt.checkBox=!0),"ed"==column.field&&(wh.editColumn=!0),columns.push(column))}),$(this).find(_cfg.columns_from).parent("tr").remove(),$(this).find(_cfg.data_from).size()||(_cfg.data_from="tr"),opt.columns=columns,opt=$.extend(!0,wh,opt,cfg),opt.url||(data=[],$(this).find(_cfg.data_from).each(function(){var b={};$(this).find(">td,>th").each(function(a){var c=$(this).html();$(this).attr("field")?b[$(this).attr("field")]=c:opt.columns[a].field&&(b[opt.columns[a].field]=c)}),data.push(b)}),opt.data=data),opt.helper=$("<div id='"+($(this).attr("id")?$(this).attr("id"):"")+"' class='datagrid "+$(this).attr("class")+"'></div>"),$(this).after(opt.helper).remove(),grid=new $.dataGrid(opt),opt.helper.data("metaData",opt),opt.helper.data("datagrid",grid),list.push(grid)}),1==this.size()?list[0]:list},$.fn.toGrid=$.fn.togrid,$.fn._resize=function(a){function c(a,b){var c,f,g,h,i;$(document.body).css("cursor","col-resize"),$(document.body).css("-moz-user-select","none"),$(document.body).attr("unselectable","on"),b.gheader.find(".datagrid-header-inner").css("cursor","col-resize"),b.gheader.find("div.datagrid-cell").css("cursor","col-resize"),c=$("<div class='datagrid-resize'></div>"),f="#view_"+b.id,$(f).append(c),g=$(this).offset().left-$(f).offset().left,h=$(f).height(),i=$(this).width(),g=parseFloat(g)+parseFloat(i),c.css({position:"absolute",top:0,zIndex:9999,height:parseFloat(h),left:g}),b.line=c,b.x=a.clientX,b.left=g,b.offsetX=0,$(document.body).bind("selectstart",function(){return!1}),$(document).bind("mousemove",function(a){var c=b.self.fireEvent("onResizeColumn",[b,a]);c!==!1&&d(a,b)}),$(document).bind("mouseup",function(a){b.stop(a,b),e(a,b)})}function d(a,b){var c=a.clientX,d=b.left+(c-b.x);b.offsetX=c-b.x,b.line.css({left:d})}function e(a,b){"#view_"+b.id,$(document).unbind("mousemove"),$(document).unbind("mouseup"),$(document.body).unbind("selectstart"),$(document.body).css("cursor","default"),$(document.body).removeAttr("unselectable"),b.gheader.find(".datagrid-header-inner").css("cursor","default"),b.gheader.find("div.datagrid-cell").css("cursor","default"),$(b.line).remove()}var b;a=a||{},a=$.extend({},a),b=this,b.each(function(){$("<div class='datagrid_resize'></div>").appendTo($(this).parent()).bind("mousedown",function(b){a.field=$(this).parent().attr("field");var d=a.self.fireEvent("onResizeColumnStart",[this,a,b]);d!==!1&&(c.call(this,b,a),b.preventDefault(),b.stopPropagation())})})},$.fn.moveColumn=function(a){function d(b){var d,e,f;c=!0,a.moveField=$(this).attr("field"),d=$('<div class="column-move" id="'+a.id+'_move" style="position:absolute;z-index:9999;">'+$(".datagrid-cell",this).html()+"</div>").appendTo("#"+a.id),e=$('<div class="column-move-line" id="'+a.id+'_line" style="position:absolute;height:'+$(this).outerHeight()+'px;"></div>').appendTo("#"+a.id),f=$("#"+a.id).offset(),d.css({left:b.pageX-f.left+10,top:b.pageY-f.top+10}),$(document.body).bind("mousemove.move",function(a){d.css({left:a.pageX-f.left+10,top:a.pageY-f.top+10}),a.preventDefault(),a.stopPropagation()}),$(document.body).bind("mouseup.move",function(b){c=!1,d.remove(),e.remove(),$(document.body).unbind("mousemove.move mouseup.move"),a.self.fireEvent("onColumnMove",[a]),b.preventDefault(),b.stopPropagation()})}var b=this,c=!1;b.bind("mousedown.move",function(b){var c=this,e=setTimeout(function(){d.call(c,b)},a.moveColumnTm);$(document.body).bind("mouseup.wt",function(){clearTimeout(e),$(document.body).unbind("mouseup.wt")}),b.preventDefault(),b.stopPropagation()}),b.bind("mousemove.h",function(b){var d,e,f,g,h,i,j,k,l,m;0!=c&&(d=$("#"+a.id).offset(),e=d.top,f=d.left,g=$(this).outerWidth(),h=$(this).height()-2,i=$(this).offset().top-e,j=$(this).offset().left-f-2,k=b.pageX,l=k-$(this).offset().left,a.moveToField=$(this).attr("field"),m=a.self.fireEvent("onColumnMoving",[a]),m!==!1&&(g/2>=l?($("#"+a.id+"_line").css({left:j,top:i,height:h}),a.moveToFieldPos=1):($("#"+a.id+"_line").css({left:j+g,top:i,height:h}),a.moveToFieldPos=0)))})}}(jQuery);