/*!artTemplate - Template Engine*/var template=function(a,b){return template["object"==typeof b?"render":"compile"].apply(template,arguments)};(function(a,b){"use strict";a.version="2.0.1",a.openTag="<%",a.closeTag="%>",a.isEscape=!0,a.isCompress=!1,a.parser=null,a.render=function(a,b){var c=d(a);return void 0===c?e({id:a,name:"Render Error",message:"No Template"}):c(b)},a.compile=function(b,d){function l(c){try{return new j(c)+""}catch(f){return h?(f.id=b||d,f.name="Render Error",f.source=d,e(f)):a.compile(b,d,!0)(c)}}var g=arguments,h=g[2],i="anonymous";"string"!=typeof d&&(h=g[1],d=g[0],b=i);try{var j=f(d,h)}catch(k){return k.id=b||d,k.name="Syntax Error",e(k)}return l.prototype=j.prototype,l.toString=function(){return""+j},b!==i&&(c[b]=l),l},a.helper=function(b,c){a.prototype[b]=c},a.onerror=function(a){var c="[template]:\n"+a.id+"\n\n[name]:\n"+a.name;a.message&&(c+="\n\n[message]:\n"+a.message),a.line&&(c+="\n\n[line]:\n"+a.line,c+="\n\n[source]:\n"+a.source.split(/\n/)[a.line-1].replace(/^[\s\t]+/,"")),a.temp&&(c+="\n\n[temp]:\n"+a.temp),b.console&&console.error(c)};var c={},d=function(d){var e=c[d];if(void 0===e&&"document"in b){var f=document.getElementById(d);if(f){var g=f.value||f.innerHTML;return a.compile(d,g.replace(/^\s*|\s*$/g,""))}}else if(c.hasOwnProperty(d))return e},e=function(b){function c(){return c+""}return a.onerror(b),c.toString=function(){return"{Template Error}"},c},f=function(){a.prototype={$render:a.render,$escape:function(a){return"string"==typeof a?a.replace(/&(?![\w#]+;)|[<>"']/g,function(a){return{"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"}[a]}):a},$string:function(a){return"string"==typeof a||"number"==typeof a?a:"function"==typeof a?a():""}};var b=Array.prototype.forEach||function(a,b){for(var c=this.length>>>0,d=0;c>d;d++)d in this&&a.call(b,this[d],d,this)},c=function(a,c){b.call(a,c)},d="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",e=/\/\*(?:.|\n)*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|'[^']*'|"[^"]*"|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g,f=/[^\w$]+/g,g=RegExp(["\\b"+d.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),h=/\b\d[^,]*/g,i=/^,+|,+$/g,j=function(a){return a=a.replace(e,"").replace(f,",").replace(g,"").replace(h,"").replace(i,""),a=a?a.split(/,+/):[]};return function(b,d){function w(b){return k+=b.split(/\n/).length-1,a.isCompress&&(b=b.replace(/[\n\r\t\s]+/g," ")),b=b.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n"),b=q[1]+"'"+b+"'"+q[2],b+"\n"}function x(b){var c=k;if(g?b=g(b):d&&(b=b.replace(/\n/g,function(){return k++,"$line="+k+";"})),0===b.indexOf("=")){var e=0!==b.indexOf("==");if(b=b.replace(/^=*|[\s;]*$/g,""),e&&a.isEscape){var f=b.replace(/\s*\([^\)]+\)/,"");m.hasOwnProperty(f)||/^(include|print)$/.test(f)||(b="$escape($string("+b+"))")}else b="$string("+b+")";b=q[1]+b+q[2]}return d&&(b="$line="+c+";"+b),y(b),b+"\n"}function y(a){a=j(a),c(a,function(a){l.hasOwnProperty(a)||(z(a),l[a]=!0)})}function z(a){var b;"print"===a?b=s:"include"===a?(n.$render=m.$render,b=t):(b="$data."+a,m.hasOwnProperty(a)&&(n[a]=m[a],b=0===a.indexOf("$")?"$helpers."+a:b+"===undefined?$helpers."+a+":"+b)),o+=a+"="+b+","}var e=a.openTag,f=a.closeTag,g=a.parser,h=b,i="",k=1,l={$data:!0,$helpers:!0,$out:!0,$line:!0},m=a.prototype,n={},o="var $helpers=this,"+(d?"$line=0,":""),p="".trim,q=p?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],r=p?"if(content!==undefined){$out+=content;return content}":"$out.push(content);",s="function(content){"+r+"}",t="function(id,data){if(data===undefined){data=$data}var content=$helpers.$render(id,data);"+r+"}";c(h.split(e),function(a){a=a.split(f);var c=a[0],d=a[1];1===a.length?i+=w(c):(i+=x(c),d&&(i+=w(d)))}),h=i,d&&(h="try{"+h+"}catch(e){"+"e.line=$line;"+"throw e"+"}"),h="'use strict';"+o+q[0]+h+"return new String("+q[3]+")";try{var u=Function("$data",h);return u.prototype=n,u}catch(v){throw v.temp="function anonymous($data) {"+h+"}",v}}}()})(template,this),"function"==typeof define?define(function(a,b,c){c.exports=template}):"undefined"!=typeof exports&&(module.exports=template);

/*
dataGrid v 1.5.7.x
*/
!function($){"use strict";$.dataGrid=function(a){this.init(a)},$.dataGrid.fn={},$.dataGrid.fn.extend=function(a){$.extend($.dataGrid.prototype,a)},$.dataGrid.extend=function(a){$.extend($.dataGrid,a)},$.dataGrid.extend({version:"1.0",padding:8,getDefaults:function(a){var b={self:null,init:$.noop,title:"",iconCls:"",toolBars:!1,_toolItem:{text:"",cls:"",callBack:$.noop,disabled:!1},ltText:"",rowNumbersWidth:!1,rowNumbersExpand:!1,rowNumbers2Row:!0,rowTpl:"",headerTpl:"",containerCss:"datagrid-container-border",border:!0,leftBorder:1,rightBorder:1,topBorder:1,bottomBorder:1,padding:$.dataGrid.padding,width:700,height:250,checkBox:!1,checkBoxWidth:"20px",checkBoxTitle:'<input type="checkbox">',checkBoxFit:!1,editColumn:!1,editColumnTitle:"操作",editColumnFit:!0,editCellW:60,columns:[],moveColumnTm:500,moveColumns:!0,_columnMetaData:{field:"",title:"",width:"120px",align:"left",_expand:!1,callBack:$.noop,hcls:"",bcls:"",fcls:"",sortable:!1,textLimit:!1,fitColumn:!0,disabled:!1},textLimit:!1,textLimitDef:"...",groupBy:!1,groupList:!1,groupListCallBack:$.noop,_groupListData:[],_sTop:0,_sLeft:0,_lTime:50,_lSize:50,fitColumns:!0,data:[],pk:"",lockRows:[],lockColumns:[],hideColumns:[],selectRows:[],isCreate:!1,isShow:!1,views:{},method:"post",url:"",loadMsg:"加载中,请稍后...",cache:!0,cacheData:[],pagination:!1,pagerToolBar:!1,pagerMsg:"当前显示 {start} 到 {end} 条，共 {total} 条",pageNumber:1,pageSize:10,dataType:"json",pageList:[10,20,30,40,50],queryParams:{},singleSelect:!1,sortName:"",sortOrder:"asc",rowStyler:"",rowCallBack:$.noop,tpl:{},methodCall:{},template:template,isEscape:!1,noop:$.noop,events:{onStart:$.noop,onFinish:$.noop,onBeforeLoad:$.noop,onLoadSuccess:$.noop,onLoadError:$.noop,onClickRow:$.noop,onColumnOver:$.noop,onColumnOut:$.noop,onOverRow:$.noop,onOutRow:$.noop,onDblClickRow:$.noop,onClickCell:$.noop,onDblClickCell:$.noop,onSortColumn:$.noop,onResizeColumnStart:$.noop,onResizeColumn:$.noop,onResizeColumnStop:$.noop,onSelect:$.noop,onUnselect:$.noop,onSelectAll:$.noop,onUnselectAll:$.noop,onHeaderContextMenu:$.noop,onHeaderCreate:$.noop,onToolBarCreate:$.noop,onRowContextMenu:$.noop,onBeforeRefresh:$.noop,onRefresh:$.noop,onChangePageSize:$.noop,onShowGriding:$.noop,onShowGrid:$.noop,onBeforeShowGrid:$.noop,onGetData:$.noop,onPagerCreate:$.noop,onSelectPage:$.noop,onClickRowNumber:$.noop,onSearch:$.noop,onExpandRow:$.noop,onLockColumn:$.noop,onBeforeLockColumn:$.noop,onAfterLockColumn:$.noop,onLockRow:$.noop,onBeforeLockRow:$.noop,onAfterLockRow:$.noop,onUnlockColumn:$.noop,onUnlockRow:$.noop,onViewSizeChange:$.noop,onSizeChange:$.noop,onScroll:$.noop,onDataChange:$.noop,onCellEdit:$.noop,onAdd:$.noop,onUpdate:$.noop,onDelete:$.noop,onAjaxAdd:$.noop,onAjaxUpdate:$.noop,onAjaxDelete:$.noop,onColumnMove:$.noop,onColumnMoving:$.noop}};return $.extend(b,a)},getToGridOptions:function(a){var b={options_from:"data-options",columns_from:"thead th",data_from:"tbody tr"};return $.extend(!0,b,a)},_undef:function(a,b){return void 0===a?b:a},_Tpl:{container:'<div class="datagrid-container <%=(border?containerCss:"")%>" id="<%=id%>" style=" position:relative; overflow:hidden; width:<%=width%>px; height:<%=height%>px;"></div>',title:'<div class="datagrid-title <%=iconCls%>" id="title_<%=id%>"><%=title%></div>',toolbar:'<div class="datagrid-toolbar" id="toolbar_<%=id%>"></div>',grid:'<div class="datagrid-view" id="view_<%=id%>" style="width:<%=width%>px; height:0px;"></div>',group_row:'<tr id="<%=id%>-group-row-<%=gid%>"  datagrid-group-row-id="<%=gid%>" class="datagrid-group-row"><td style="width:<%=w%>px" colspan="<%=colspan%>"><div  class="datagrid-group-cell"><%=html%>(<%=num%>)</div></td></tr>',view1:'<div class="datagrid-view1" id="view1_<%=id%>" style="width:<%=parseFloat(rowNumbersWidth)%>px;height:100%;"><div  class="datagrid-header" id="view1-datagrid-header-<%=id%>" style="width: 100%; z-index:40; position:relative;"><div class="datagrid-header-inner" id="view1-datagrid-header-inner-<%=id%>"><div class="datagrid-header-inner-wraper"><table class="datagrid-htable" id="view1-datagrid-header-inner-htable-<%=id%>" border="0" cellspacing="0" cellpadding="0"><tbody id="view1-datagrid-header-inner-htable-tbody-<%=id%>"></tbody></table></div></div><div class="datagrid-header-outer" id="view1-datagrid-header-outer-<%=id%>"><div class="datagrid-header-outer-wraper"><table class="datagrid-locktable" id="view1-datagrid-header-outer-locktable-<%=id%>" border="0" cellspacing="0" cellpadding="0"><tbody id="view1-datagrid-header-outer-locktable-tbody-<%=id%>"></tbody></table></div></div></div><div class="datagrid-body-wrap" id="view1-datagrid-body-wrap-<%=id%>" style="width: 100%; height:0px; overflow:hidden;zoom:1; "><div class="datagrid-body" id="view1-datagrid-body-<%=id%>" style="width: 100%;float:left;z-index:30;position:relative;"><table class="datagrid-btable" id="view1-datagrid-body-btable-<%=id%>" cellspacing="0" cellpadding="0" border="0"><tbody id="view1-datagrid-body-btable-tbody-<%=id%>"></tbody></table></div></div><div class="datagrid-footer" id="view1-datagrid-footer-<%=id%>" style="width: 100%; height:0px; overflow:hidden;position:relative;z-index:31;"></div></div>',view2:'<div class="datagrid-view2" id="view2_<%=id%>" style="width:0px;height:100%;"><div  class="datagrid-header" id="view2-datagrid-header-<%=id%>" style="width: 100%;"><div class="datagrid-header-inner" id="view2-datagrid-header-inner-<%=id%>"><div class="datagrid-header-inner-wraper"><table class="datagrid-htable" id="view2-datagrid-header-inner-htable-<%=id%>" border="0" cellspacing="0" cellpadding="0"><tbody id="view2-datagrid-header-inner-htable-tbody-<%=id%>"></tbody></table></div></div><div class="datagrid-header-outer" id="view2-datagrid-header-outer-<%=id%>"><div class="datagrid-header-outer-wraper"><table class="datagrid-locktable" id="view2-datagrid-header-outer-locktable-<%=id%>" border="0" cellspacing="0" cellpadding="0"><tbody id="view2-datagrid-header-outer-locktable-tbody-<%=id%>"></tbody></table></div></div></div><div class="datagrid-body" id="view2-datagrid-body-<%=id%>" style="width: 100%;height:0px;"><table class="datagrid-btable" id="view2-datagrid-body-btable-<%=id%>" cellspacing="0" cellpadding="0" border="0"><tbody id="view2-datagrid-body-btable-tbody-<%=id%>"></tbody></table></div><div class="datagrid-footer" id="view2-datagrid-footer-<%=id%>" style="width: 100%; height:0px; overflow:hidden;"></div></div>',pager:'<div class="datagrid-pager pagination"> <table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td><select class="pagination-page-list"><% var s = ""; for(var i=0;i<pageList.length;i++) {%><% if(pageList[i] == pageSize) {%><% s="selected";%><% } else {s="";} %><option value="<%=pageList[i]%>" <%=s%> ><%=pageList[i]%></option><% } %></select></td><td><div class="pagination-btn-separator"></div></td><td><a href="javascript:void(0)" class=" p-plain <%=(pageNumber <= 1 )?"p-btn-disabled":""%>"><span class="pagination-first  p-btn">&nbsp;</span></a></td><td><a href="javascript:void(0)" class=" p-plain <%=(pageNumber <= 1 )?"p-btn-disabled":""%>"><span class="pagination-prev  p-btn">&nbsp;</span></a></td><td><div class="pagination-btn-separator"></div></td><td><span style="padding-left:6px;">第</span></td><td><input class="pagination-num" type="text" value="<%=pageNumber%>" size="2"></td><td><span style="padding-right:6px;">页 共 <%=pages%> 页</span></td><td><div class="pagination-btn-separator"></div></td><td><a href="javascript:void(0)" class=" p-plain <%=(pageNumber >= pages)?"p-btn-disabled":""%>"><span class="pagination-next p-btn">&nbsp;</span></a></td><td><a href="javascript:void(0)" class=" p-plain <%=(pageNumber >= pages)?"p-btn-disabled":""%>"><span class="pagination-last p-btn ">&nbsp;</span></a></td><td><div class="pagination-btn-separator"></div></td><td><a href="javascript:void(0)" class=" p-plain"><span class="pagination-load p-btn">&nbsp;</span></a></td><td id="pagination-toolbar-<%=id%>"></td></tr></tbody></table><div class="pagination-info"><%=pagerMsg%></div><div style="clear:both;"></div></div>',view1_header_inner_row:'<tr class="datagrid-header-row"><td align="center" class="datagrid-td-rownumber" style=""><div class="datagrid-header-rownumber" style="width:<%=parseFloat(rowNumbersWidth)%>px;"><%=ltText%></div></td></tr>',view1_header_outer_row:"",view2_header_inner_row:'<tr class="datagrid-header-row"><% for(var i in fields) {%><td field="<%=fields[i]["field"]%>" align="<%=fields[i]["align"]%>"><div class="datagrid-header-wrap" field="<%=fields[i]["field"]%>" ><div class="datagrid-cell <%=fields[i]["hcls"]%>"  style="width:<%=fields[i]["width"]%>"><span><%=fields[i]["title"]%></span><span class="datagrid-sort-icon">&nbsp;</span></div></div></td><% } %></tr>',view2_header_outer_row:"",view1_row:'<tr id="<%=id%>-view1-row-<%=i%>" <%=( typeof data["_groupid_"] != "undefined" ) ? "datagrid-group-id="+data["_groupid_"] : ""%> datagrid-row-index="<%=i%>" datagrid-row-select="0" class="datagrid-row datagrid-row-view1 <%=((i+1)%2 ? "datagrid-row-view1-single" : "datagrid-row-view1-double")%>"><td align="center" class="datagrid-td-rownumber"><div class="datagrid-cell-rownumber" style="width:<%=parseFloat(rowNumbersWidth)%>px;"><%var j = i%><%=(rowNumbersExpand === false ? ++j : opt.self.tpl(rowNumbersExpand,data))%></div></td></tr>',view2_row:'<tr id="<%=id%>-row-<%=i%>" <%=( typeof data["_groupid_"] != "undefined" )? "datagrid-group-id="+data["_groupid_"] : ""%> datagrid-row-index="<%=i%>" datagrid-row-select="0" class="datagrid-row <%=((i+1)%2 ? "datagrid-row-single" : "datagrid-row-double")%>"><% for(var j in fields) {%><% var field = fields[j]["field"];%><td field="<%=fields[j]["field"]%>" align="<%=fields[j]["align"]%>"><div class="datagrid-cell datagrid-cell-c1-<%=fields[j]["field"]%> <%=fields[j]["bcls"]%>" style="width:<%=fields[j]["width"]%>;" ><%=fields[j]["_expand"] !== false ? opt.self.tpl(fields[j]["_expand"],data) : data[field]%></div></td><% } %></tr>'}}),$.dataGrid.fn.extend({init:function(a){var c,d,b=this;b.initEvents(a),b.configs=$.extend({},$.dataGrid.getDefaults(),a),c=b.configs,c.self=b,c.template.isEscape=c.isEscape,c.template.helper("parseInt",parseInt),c.template.helper("parseFloat",parseFloat),c.border&&(c.width-=c.leftBorder+c.rightBorder,c.height-=c.topBorder+c.bottomBorder),c.id=c.id||b.getId(),c.gid=c.gid||"#view_"+c.id,c.rowNumbersWidth=parseFloat(c.rowNumbersWidth)>=0?c.rowNumbersWidth:!1,c.rowNumbersWidth===!1&&(c.rowNumbersWidth=0==c.groupBy?!1:"0px"),c.rowNumbersWidth===!1&&(c.rowNumbersWidth=c.lockColumns.length?"0px":!1);for(d in c.columns)c.columns[d].width&&(c.columns[d].width=parseFloat(c.columns[d].width)-c.padding);c.init.call(b,c),b.sysEvents(),b.fireEvent("onStart",b,[c]),b.setContainer().setTitle().setToolBar().setGrid().setPager(!0).show()},inArray:function(a,b){var c,d;if(b)for(c=b.length,d=0;c>d;d++)if(d in b&&b[d]==a)return d;return-1},tpl:function(a,b){var c=this,d=c.configs,e=d.template.compile(a);return e(b)},bind:function(a,b){var c,d,e;return"undefined"==typeof a?this:(b=b||$.noop,c=this,d=c.configs.events,d[a]=$.dataGrid._undef(d[a],[]),$.isFunction(d[a])&&(d[a]=[]),e=d[a].push(b),e-1)},unbind:function(a,b){var c=this,d=c.configs.events;return b=$.dataGrid._undef(b,!1),b===!1?d[a]=$.noop:d[a][b]=$.noop,c},fireEvent:function(a,b,c){var f,g,d=this,e=d.configs.events[a];if(b=$.dataGrid._undef(b,d),c=$.dataGrid._undef(c,[]),f=!0,$.isArray(e))for(g=0;g<e.length&&(f=e[g].apply(b,c),f!==!1);g++);else $.isFunction(e)&&(f=e.apply(b,c));return f},initEvents:function(a){var d,c=a.events?a.events:{};if($.isPlainObject(c)&&!$.isEmptyObject(c))for(d in c)$.isFunction(c[d])&&c[d]!==$.noop&&(c[d]=[c[d]])},sysEvents:function(){var a=this;a.configs,a.bind("onShowGrid",a.autoExpand),a.bind("onClickRow",a.setExpandEvent),a.bind("onUnselectAll",function(){this.checkCk(!1)}),a.bind("onSelectAll",function(){this.checkCk(!0)}),a.bind("onUnselect",function(){this.checkCk(!1)}),a.bind("onShowGrid",function(){this.checkCk(!1)}),a.bind("onLoadSuccess",a.onLoadSuccess),a.bind("onLoadError",a.onLoadError),a.bind("onSetPk",a.setPk),a.bind("onViewSizeChange",a.onViewSizeChange),a.bind("onSizeChange",a.onSizeChange),a.bind("onShowGrid",a.onLockRow),a.bind("onShowGrid",a.onLockColumn),a.bind("onBeforeShowGrid",a.onBeforeShowGrid),a.bind("onScroll",a.onScroll),a.bind("onAfterLockRow",a.onAfterLockRow),a.bind("onAfterLockColumn",a.onAfterLockColumn),a.bind("onDataChange",a.onDataChange),a.bind("onOverRow",a.onOverRow),a.bind("onOutRow",a.onOutRow),a.bind("onShowGrid",a.onDisplayField),a.bind("onHeaderCreate",a.onHeaderCreate),a.bind("onColumnMove",a.onColumnMove),a.bind("onSelect",a.addSelectRecode),a.bind("onUnselect",a.removeSelectRecode)},getId:function(){return"datagrid_"+Math.floor(99999*Math.random())},unique:function(){return"unique_"+Math.floor(99999*Math.random())},showLoading:function(a,b){var e,c=this,d=c.configs;a="undefined"==typeof a?d.loadMsg:a,b=b||"#"+d.id,c.hideLoading(b),$('<div class="datagrid-mask" style="display:block"></div><div class="datagrid-mask-msg" style="display: block; left: 50%;">'+a+"</div>").appendTo(b),e=$(b).find("> .datagrid-mask-msg").outerWidth(!0),$(b).find(">.datagrid-mask-msg").css("marginLeft",-e/2+"px"),$(b).find(">.datagrid-mask").click(function(){return!1})},hideLoading:function(a){var b=this,c=b.configs;a=a||"#view_"+c.id,$("#"+c.id).find(".datagrid-mask-msg,.datagrid-mask").remove()},methodCall:function(a){var b,c;return a=a||"",b=this,c=b.configs,""!=a&&a in c.methodCall&&$.isFunction(c.methodCall[a])&&c.methodCall[a].call(b),b},getColumnData:function(a,b,c){var f,g,d=this,e=d.configs;if(a=$.dataGrid._undef(a,!1),b=$.dataGrid._undef(b,!1),a===!1)return d;f=d.getColumns(!0);for(g in f)if(f[g].field==a)return b===!1?f[g]:"undefined"==typeof c?f[g][b]:(f[g][b]=c,e.columns=f,d.setGridHeader(),d.refreshDataCache(),d);return null},setColumnData:function(a,b,c){var d=this;return d.getColumnData(a,b,c)},getData:function(){var a=this,b=a.configs,c=a.getAsync();return c?b.cacheData.source:b.data},textLimit:function(a,b,c){var f,g,h,i,j,d=this,e=d.configs;if(a=$.dataGrid._undef(a,""),""==a)return a;for(a=new String(a),f=$("<div style='position:absolute;left:-1000px;'></div>"),f.appendTo(document.body),f.css({fontSize:c}),g=a.length,h="",i=0,j=1;g>=j&&(h=a.substr(0,j),f.html(h+e.textLimitDef),parseFloat(f.width())<parseFloat(b));j++)i=j;return f.remove(),0==i?a.substr(0,1)+e.textLimitDef:i==g?a:a.substr(0,i)+e.textLimitDef},getTpl:function(a){var b,c,d;return a=a||"",b=this,c=b.configs,template.isEscape=c.isEscape,d=a in c.tpl?$(c.tpl[a]).html():$.dataGrid._Tpl[a],d=""==d?$.dataGrid._Tpl[a]:d},setContainer:function(a){var b,c;return a=a||{},b=this,a=b.configs,c=b.tpl(b.getTpl("container"),a),a.helper.html(c),b},setTitle:function(a){var d,b=this,c=b.configs;return c.title="undefined"==typeof a?c.title:a,""==c.title?b:(d=b.tpl(b.getTpl("title"),c),b.configs.views.title=$(d),b)},getTools:function(a){var d,e,f,g,h,b=this,c=b.configs;if($.isPlainObject(a)&&(a=[a]),!$.isArray(a)&&!$.isPlainObject(a))return $(a);d=c._toolItem,e='<table cellspacing="0" cellpadding="0" border="0"><tbody><tr>{$tools}</tr></tbody></table>',f="";for(g in a)$.isPlainObject(a[g])?(a[g]=$.extend({},d,a[g]),""!=a[g].cls&&(a[g].cls+=" l-btn-icon-left"),h=a[g].disabled?"l-btn-disabled":"",f+='<td><a href="javascript:void(0)" class="l-btn l-btn-plain '+h+'" indexid="'+g+'"><span class="l-btn-left"><span class="l-btn-text '+a[g].cls+'">'+a[g].text+"</span></span></a></td>"):f+="|"==a[g]||"-"==a[g]||";"==a[g]||","==a[g]?'<td><div class="datagrid-btn-separator"></div></td>':"<td>"+a[g]+"</td>";return e=e.replace("{$tools}",f),e=$(e),e.find(".l-btn").each(function(){$(this).click(function(c){var d=$(this).attr("indexid");a[d].callBack.call(b,this,a[d]),c.stopPropagation(),c.preventDefault()})}),e},setToolBar:function(){var c,d,a=this,b=a.configs;return b.toolBars===!1?a:(c=a.tpl(a.getTpl("toolbar"),b),a.configs.views.toolbar=$(c),d=a.getTools(b.toolBars),d!==!1&&a.configs.views.toolbar.append(d),a.fireEvent("onToolBarCreate",a,[a.configs.views.toolbar,b.toolBars]),a.methodCall("setToolBar"),a)},setGrid:function(){var d,e,f,g,a=this,b=a.configs,c=b.views;if(c.grid){e=c.grid,f=0;for(g in c)"grid"!=g&&(f+=c[g].outerHeight(!0));e.height(b.height-f)}else d=a.tpl(a.getTpl("grid"),b),a.configs.views.grid=$(d);return a.methodCall("setGrid"),a},autoExpand:function(){var c,a=this,b=a.configs;for(c in b.data)"_expand"in b.data[c]&&"_openExpand"in b.data[c]&&b.data[c]._openExpand&&a.expandRow(c,b.data[c]._expand)},checkCk:function(a){var b=this,c=b.configs;c.gid,a=$.dataGrid._undef(a,!1),$("#view2-datagrid-header-inner-htable-tbody-"+c.id).find(">.datagrid-header-row td[field='ck']").find("input:checkbox").each(function(){this.checked=a?!0:!1})},setExpandEvent:function(a,b,c){var d=this;d.configs,"_expand"in c&&(d.isExpandRowShow(b)?d.hideExpandRow(b):d.expandRow(b,c._expand))},addPagerEvent:function(){var a=this,b=a.configs,c=b.views.pager;return c.find(".pagination-first").click(function(){$(this).parent().hasClass("p-btn-disabled")||(b.pageNumber=1,a.refreshData())}),c.find(".pagination-prev").click(function(){if(!$(this).parent().hasClass("p-btn-disabled")){var c=b.pageNumber-1;b.pageNumber=0>c?1:c,a.refreshData()}}),c.find(".pagination-next").click(function(){var c,d,e;$(this).parent().hasClass("p-btn-disabled")||(c=b.total||b.data.length,d=Math.ceil(parseInt(c)/parseInt(b.pageSize)),e=b.pageNumber+1,b.pageNumber=e>d?d:e,a.refreshData())}),c.find(".pagination-last").click(function(){var c,d;$(this).parent().hasClass("p-btn-disabled")||(c=b.total||b.data.length,d=Math.ceil(parseInt(c)/parseInt(b.pageSize)),b.pageNumber=d,a.refreshData())}),c.find(".pagination-load").click(function(){$(this).parent().hasClass("p-btn-disabled")||a.refreshData()}),c.find(".pagination-page-list").change(function(){var c=$(this).val(),d=a.fireEvent("onChangePageSize",a,[c]);return d===!1?!1:(b.pageSize=c,d=a.fireEvent("onSelectPage",a,[c]),d===!1?!1:(a.refreshData(),void 0))}),c.find(".pagination-num").keydown(function(d){13===d.keyCode&&(b.pageNumber=c.find(".pagination-num").val(),a.refreshData())}),a},setPager:function(a){var d,e,f,b=this,c=b.configs;return a=$.dataGrid._undef(a,!1),c.pagination?(d={},d.id=c.id,d.total=c.total||c.data.length,d.pageSize=c.pageSize,d.pageNumber=c.pageNumber,d.pageList=c.pageList,d.pages=Math.ceil(parseInt(d.total)/parseInt(d.pageSize)),c.pageNumber=c.pageNumber>d.pages?d.pages:c.pageNumber,c.pageNumber=c.pageNumber<=0?1:c.pageNumber,d.pageNumber=c.pageNumber,d.start=d.pageNumber*d.pageSize-d.pageSize+1<0?0:d.pageNumber*d.pageSize-d.pageSize+1,d.end=d.pageNumber*d.pageSize,d.pagerMsg=c.pagerMsg.replace("{start}",d.start).replace("{end}",d.end).replace("{total}",d.total),c.id&&(e=$("#"+c.id).find(">.datagrid-pager").size()),f=b.tpl(b.getTpl("pager"),d),e?($("#"+c.id).find(">.datagrid-pager").replaceWith(f),c.views.pager=$("#"+c.id).find(">.datagrid-pager")):c.views.pager=$(f),a?b:(b.addPagerEvent(),$.isArray(c.pagerToolBar)&&c.pagerToolBar.length&&$("#pagination-toolbar-"+c.id).append(b.getTools(c.pagerToolBar)),b.fireEvent("onPagerCreate",b,[c.views.pager]),b.methodCall("setPager"),b)):b},onSizeChange:function(a,b){var c=this,d=c.configs;d.width=$.dataGrid._undef(a,d.width),d.height=$.dataGrid._undef(b,d.height),d.border&&(d.width-=d.leftBorder+d.rightBorder,d.height-=d.topBorder+d.bottomBorder),$("#"+d.id).css({width:d.width,height:d.height}),$("#view_"+d.id).css({width:d.width}),c.setGrid(),c.fireEvent("onViewSizeChange",c,[])},onViewSizeChange:function(){var f,g,h,i,j,k,l,a=this,b=a.configs,c=b.gid,d=$(c).width();$(c).height(),f=$("#view1_"+b.id),g=$("#view2_"+b.id),h=$("#view1-datagrid-header-inner-htable-"+b.id).outerWidth(),f.width(h),g.width(d-parseFloat(h)),i=$("#view2-datagrid-header-inner-htable-"+b.id).outerHeight(),$("#view1-datagrid-header-inner-htable-"+b.id).height(i),i=parseFloat(i)-1,$("#view1-datagrid-header-inner-"+b.id+",#view2-datagrid-header-inner-"+b.id).height(i),j=$("#view2-datagrid-header-outer-locktable-"+b.id).outerHeight(),$("#view1-datagrid-header-outer-"+b.id+",#view2-datagrid-header-outer-"+b.id).height(j),k=parseFloat($("#view2-datagrid-header-inner-"+b.id).outerHeight())+parseFloat($("#view2-datagrid-header-outer-"+b.id).outerHeight()),$("#view1-datagrid-header-"+b.id).height(k),$("#view2-datagrid-header-"+b.id).height(k),l=g.height()-b.gheader.height()-b.gfooter.height(),b.gbody.height(l),$("#view1-datagrid-body-wrap-"+b.id).height(l),a.fireEvent("onScroll",a,[])},array_sort:function(a,b,c,d){var e,f,g,h,i,j,k;if(b==c)return a;e=a,a=[];for(f in e)g=a.push(f),f==b?b=g-1:f==c&&(c=g-1);if(h=a[b],b>c)for(d||c++,i=b;i>=0;i--){if(i==c){a[i]=h;break}a[i]=a[i-1]}else if(c>b)for(d&&c--,i=b;c>=i;i++)a[i]=i==c?h:a[i+1];j=[];for(k in a)j.push(e[a[k]]);return a=j},onColumnMove:function(a){var c,d,e,f,g,h,b=this;if(a=b.configs,c=b.getColumns(),d=0,e=0,f=a.moveToFieldPos,a.moveField!=a.moveToField&&-1==b.inArray(a.moveField,a.lockColumns)&&-1==b.inArray(a.moveToField,a.lockColumns)){for(g in c)c[g].field==a.moveField&&(d=g),c[g].field==a.moveToField&&(e=g);if(c=a.columns=b.array_sort(c,d,e,f),f){d=$("#view2-datagrid-header-inner-htable-tbody-"+a.id).find("td[field='"+a.moveField+"']"),e=$("#view2-datagrid-header-inner-htable-tbody-"+a.id).find("td[field='"+a.moveToField+"']"),e.before(d);for(h in a.data)d=$("#"+a.id+"-row-"+h).find("td[field='"+a.moveField+"']"),e=$("#"+a.id+"-row-"+h).find("td[field='"+a.moveToField+"']"),e.before(d)}else{d=$("#view2-datagrid-header-inner-htable-tbody-"+a.id).find("td[field='"+a.moveField+"']"),e=$("#view2-datagrid-header-inner-htable-tbody-"+a.id).find("td[field='"+a.moveToField+"']"),e.after(d);for(h in a.data)d=$("#"+a.id+"-row-"+h).find("td[field='"+a.moveField+"']"),e=$("#"+a.id+"-row-"+h).find("td[field='"+a.moveToField+"']"),e.after(d)}}},setView:function(){var a=this,b=a.configs,c=a.tpl(a.getTpl("view1"),b),d=a.tpl(a.getTpl("view2"),b),e=b.gid;$(e).html(""),$(c).appendTo(e),$(d).appendTo(e),b.gheader=$("#view2-datagrid-header-"+b.id),b.gbody=$("#view2-datagrid-body-"+b.id),b.gfooter=$("#view2-datagrid-footer-"+b.id),b.gbody.scroll(function(){a.fireEvent("onScroll",a,[])})},getRowData:function(a,b){var e,f,g,c=this,d=c.configs;if(b=$.dataGrid._undef(b,!1),e=b?c.getData():d.data,!b)return e[a];f=d.pk;for(g in e)if(e[g][f]==a)return e[g];return!1},setRowData:function(a,b,c){var g,d=this,e=d.configs,f=e.data;return f[a][b]=c,g=!1,"undefined"!=typeof f[a].pk&&(g=d.getRowData(f[a].pk,!0),g&&(g[b]=c)),d},getFieldValue:function(a,b){var c=this.getRowData(a);return c[b]},setFieldValue:function(a,b,c){var g,h,i,j,d=this,e=d.configs;return e.gid,g=d.getRowData(a),g[b]==c?!1:(h="#"+e.id+"-row-"+a+",#"+e.id+"-view1-row-"+a,i=$(h).find("td[field='"+b+"'] div.datagrid-cell"),i.html(c).addClass("datagrid-cell-edit"),j=d.getColumnData(b,"callBack"),null!=j&&$.isFunction(j)&&j!=e.noop&&j.call(d,i,a,b,g),d.setRowData(a,b,c),d.fireEvent("onCellEdit",d,[i,a,b,g]),g)},getSlectRows:function(a){var f,g,b=this,c=b.configs,d=c.gid,e=[];if(a=$.dataGrid._undef(a,!1),$(d).find(">.datagrid-view2 tr.datagrid-row[datagrid-row-select='1']").each(function(){e.push($(this).attr("datagrid-row-index"))}),f=[],a){for(g=0;g<e.length;g++)f.push(c.data[e[g]]);return f}return e},onLockRow:function(){var d,a=this,b=a.configs,c=b.lockRows;for(d in c)null!=c[d]&&a.lockRow(c[d])},onAfterLockRow:function(a){var e,f,g,b=this,c=b.configs,d=b.getRowData(a);$("#"+c.id+"-expand-row-"+a).size()&&(e=$("#"+c.id+"-expand-row-"+a).is(":hidden"),b.expandRow(a,d._expand),e&&b.hideExpandRow(a)),c.groupBy&&(f=$("#view2-datagrid-body-btable-tbody-"+c.id),f.find("tr.datagrid-group-row").each(function(){var b=$(this).attr("datagrid-group-row-id"),c=f.find("tr[datagrid-group-id='"+b+"']").first();$(this).insertBefore(c)}),g=$("#view1-datagrid-body-btable-tbody-"+c.id),g.find("tr.datagrid-group-row-view1").each(function(){var b=$(this).attr("datagrid-group-row-id"),c=g.find("tr[datagrid-group-id='"+b+"']").first();$(this).insertBefore(c)})),b.changeExpandPos()},onLockColumn:function(){var d,a=this,b=a.configs,c=b.lockColumns;for(d in c)a.lockColumn(c[d])},onAfterLockColumn:function(){var b=this,c=b.configs;c.gid,$("#view2_"+c.id).find("tr.datagrid-row-expand").each(function(){var d=$(this).attr("datagrid-expand-row-index"),e=$(this).is(":hidden"),f=b.getRowData(d);$("#"+c.id+"-expand-row-"+d).size()&&(b.expandRow(d,f._expand),e&&b.hideExpandRow(d))}),b.setExpandRowSize(),b.addGroupRow()},lockRow:function(a){var b=this,c=b.configs;b._lockRow(a)&&(-1==b.inArray(a,c.lockRows)&&c.lockRows.push(a),b.fireEvent("onAfterLockRow",b,[a]),b.fireEvent("onViewSizeChange",b,[]))},unLockRow:function(a){var d,e,f,b=this,c=b.configs;if(b._unLockRow(a)){for(d in c.lockRows)c.lockRows[d]==a&&(c.lockRows[d]=null);e=[];for(f in c.lockRows)null!==c.lockRows[f]&&e.push(c.lockRows[f]);c.lockRows=e,b.onAfterLockRow(a),b.fireEvent("onViewSizeChange",b,[])}},unLockColumn:function(a){var d,e,f,b=this,c=b.configs;if(b._unLockColumn(a)){for(d in c.lockColumns)c.lockColumns[d]==a&&(c.lockColumns[d]=null);e=[];for(f in c.lockColumns)null!==c.lockColumns[f]&&e.push(c.lockColumns[f]);c.lockColumns=e,b.onAfterLockColumn(a),b.fireEvent("onViewSizeChange",b,[])}},lockColumn:function(a){var b=this,c=b.configs;b._lockColumn(a)&&(-1==b.inArray(a,c.lockColumns)&&c.lockColumns.push(a),b.fireEvent("onAfterLockColumn",b,[a]),b.fireEvent("onViewSizeChange",b,[]))},_lockRow:function(a){var g,h,b=this,c=b.configs,d=c.gid,e=d,f=b.fireEvent("onBeforeLockRow",b,[a]);return f===!1?!1:(g=$(e).find("#"+c.id+"-row-"+a),h=$(e).find("#"+c.id+"-view1-row-"+a),g.length?($("#view2-datagrid-header-outer-locktable-tbody-"+c.id).append(g),$("#view1-datagrid-header-outer-locktable-tbody-"+c.id).append(h),!0):!1)},_unLockRow:function(a){var g,h,j,b=this,c=b.configs,d=c.gid,e=d,f=b.fireEvent("onUnlockRow",b,[a]);if(f===!1)return!1;if(g=$(e).find("#"+c.id+"-row-"+a),h=$(e).find("#"+c.id+"-view1-row-"+a),!g.length)return!1;if(-1==b.inArray(a,c.lockRows))return!1;for(c.data,j=a-1;j>=-1&&-1!=b.inArray(j,c.lockRows);j--);return a=j,a>=0?(g.insertAfter("#"+c.id+"-row-"+a),h.insertAfter("#"+c.id+"-view1-row-"+a)):($("#view2-datagrid-body-btable-tbody-"+c.id).prepend(g),$("#view1-datagrid-body-btable-tbody-"+c.id).prepend(h)),!0},_getRowNumber:function(a){var f,g,h,i,b=this,c=b.configs,d=c.data;return c.gid,f=$("#"+c.id+"-view1-row-"+a),g=!1,f.size()||(g=!0,h=b.getTpl("view1_row"),_d={i:a,id:c.id,rowNumbersExpand:c.rowNumbersExpand?c.rowNumbersExpand:!1,data:d[a],groupBy:c.groupBy,rowNumbersWidth:c.rowNumbersWidth,opt:c},i=$(b.tpl(h,_d)),b.bindRowEvent(!1,i),f=i),{isNew:g,node:f}},_lockColumn:function(a){var g,h,i,k,l,b=this,c=b.configs;if(c.data,c.gid,g=b.fireEvent("onBeforeLockColumn",b,[a]),g===!1)return!1;h=b.getColumnList(),a=$.isArray(a)?a:[a],i="#view1-datagrid-header-inner-htable-tbody-"+c.id,"#view1-datagrid-header-outer-locktable-tbody-"+c.id;for(k in a)null!=a[k]&&-1!=b.inArray(a[k],h)&&(l=$("#view2-datagrid-header-inner-htable-tbody-"+c.id).find(">tr.datagrid-header-row td[field='"+a[k]+"']"),$(i).find(">tr.datagrid-header-row").append(l),$("#view2-datagrid-header-outer-locktable-tbody-"+c.id).find(">tr.datagrid-row td[field='"+a[k]+"']").each(function(){var d=$(this).parent().attr("datagrid-row-index"),e=b._getRowNumber(d);e.isNew&&$("#view1-datagrid-header-outer-locktable-tbody-"+c.id).append(e.node),$(this).appendTo(e.node)}),$("#view2-datagrid-body-btable-tbody-"+c.id).find(">tr.datagrid-row td[field='"+a[k]+"']").each(function(){var d=$(this).parent().attr("datagrid-row-index"),e=b._getRowNumber(d);e.isNew&&$("#view1-datagrid-body-btable-tbody-"+c.id).append(e.node),$(this).appendTo(e.node)}),$("#view2-datagrid-footer-btable-tbody-"+c.id).find(">tr.datagrid-footer-row td[field='"+a[k]+"']").each(function(){var d=$(this).parent().attr("datagrid-row-index"),e=b._getRowNumber(d);e.isNew&&$("#view1-datagrid-footer-btable-tbody-"+c.id).append(e.node),$(this).appendTo(e.node)}));return!0},_unLockColumn:function(a){var g,h,i,j,n,o,p,b=this,c=b.configs,d=c.gid,f=b.fireEvent("onUnlockColumn",b,[a]);if(f===!1)return!1;g=b.getColumns(),h=!1;for(i in g)if(g[i].field==a){h=!0;break}if(!h)return!1;if(-1==b.inArray(a,c.lockColumns))return!1;j=$("#view1-datagrid-header-inner-htable-tbody-"+c.id).find(">tr.datagrid-header-row td[field='"+a+"']"),$(d),$("#view1_"+c.id),$("#view2_"+c.id),n=i;for(o in g)if(g[o].field==a)break;for(o-=1;o>=-1&&!(0>o)&&(p=g[o].field,-1!=b.inArray(p,c.lockColumns));o--);return n=o,0>n?j.prependTo($("#view2-datagrid-header-inner-htable-tbody-"+c.id).find(">tr.datagrid-header-row")):j.insertAfter($("#view2-datagrid-header-inner-htable-tbody-"+c.id).find(">tr.datagrid-header-row").find("td[field]").eq(n)),$("#view1-datagrid-header-outer-locktable-tbody-"+c.id).find(">tr.datagrid-row td[field='"+a+"']").each(function(){var b=$(this).parent(),d=b.attr("datagrid-row-index"),e=$("#"+c.id+"-row-"+d);0>n?e.prepend($(this)):e.find(">td").eq(n).after($(this))}),$("#view1-datagrid-body-btable-tbody-"+c.id).find(">tr.datagrid-row td[field='"+a+"']").each(function(){var b=$(this).parent(),d=b.attr("datagrid-row-index"),e=$("#"+c.id+"-row-"+d);0>n?e.prepend($(this)):e.find(">td").eq(n).after($(this))}),$("#view1-datagrid-footer-btable-tbody-"+c.id).find(">tr.datagrid-row td[field='"+a+"']").each(function(){var b=$(this).parent(),d=b.attr("datagrid-row-index"),e=$("#"+c.id+"-row-"+d);0>n?e.prepend($(this)):e.find(">td").eq(n).after($(this))}),!0},getCheckBoxColumn:function(){var b=this,c=b.configs,d=$.extend({},c._columnMetaData);return d.field="ck",d.title=c.checkBoxTitle,d._expand='<input type="checkbox">',d.hcls="datagrid-header-check",d.bcls="datagrid-cell-check",d.width=c.checkBoxWidth,d.fitColumn=c.checkBoxFit,d.align="center",d.callBack=function(a,b){var e=this;$(a).find("input:checkbox").click(function(a){this.checked?e.selectRow(b):e.unselectRow(b),a.stopPropagation()})},d},geteditColumn:function(){var g,b=this,c=b.configs,d=$.extend({},c._columnMetaData),e=0,f=0;return $.isArray(c.editColumn)?$.each(c.editColumn,function(a){$.isPlainObject(this)?(c.editColumn[a]=$.extend({},c._toolItem,c.editColumn[a]),e++):f++}):c.editColumn=[],g="",d.field="ed",d.title=""==c.editColumnTitle||c.editColumnTitle===!1?" ":c.editColumnTitle,d._expand=g,d.hcls="datagrid-header-edit",d.bcls="datagrid-cell-edit",d.width=e*c.editCellW+4*f+"px",d.fitColumn=c.editColumnFit,d.align="center",d.callBack=function(a,b,d,e){var j,k,f=this,g=c._toolItem,h=[],i={};for(j in c.editColumn)$.isPlainObject(c.editColumn[j])?(i=$.extend(!0,{},g,c.editColumn[j]),i.callBack=function(a,g){var h=$(a).attr("indexid");c.editColumn[h].callBack.call(f,a,b,d,e,g)},h.push(i)):h.push(c.editColumn[j]);k=f.getTools(h),a.append(k)},d},getColumns:function(a){var e,f,g,h,i,j,b=this,c=b.configs,d=c.columns;if(a=$.dataGrid._undef(a,!1),c.cacheData.columns=$.dataGrid._undef(c.cacheData.columns,d),a)return c.cacheData.columns;if(d.length<=0&&c.data.length>0)for(e in c.data[0])d.push({field:e});f=[],g=!1,h=!1;for(e in d)d[e]=$.extend({},c._columnMetaData,d[e]),d[e].disabled!==!0&&("number"==typeof d[e].width&&(d[e].width+="px"),d[e].title=""==d[e].title?d[e].field:d[e].title,c.checkBox!==!1&&"ck"==d[e].field&&g===!1&&(d[e]=b.getCheckBoxColumn(d),g=!0),c.editColumn!==!1&&"ed"==d[e].field&&h===!1&&(d[e]=b.geteditColumn(d),h=!0),f.push(d[e]));return c.columns=d=f,i=[],j=[],c.checkBox!==!1&&g===!1&&b.getCheckBoxColumn(d)!==!1&&(i=[b.getCheckBoxColumn(d)],$.merge(i,d),d=i),c.editColumn!==!1&&h===!1&&b.geteditColumn(d)!==!1&&(j=[b.geteditColumn(d)],$.merge(d,j)),c.columns=d,c.columns},getColumnList:function(){var d,e,f,a=this,b=a.configs;b.gid,d=a.getColumns(),e=[];for(f in d)e.push(d[f].field);return e},onDisplayField:function(){var e,a=this,b=a.configs,c=b.hideColumns;if(b.gid,!(c.length<=0))for(e in c)null!=c[e]&&a.hideColumn(c[e])},displayColumn:function(a,b){var f,g,h,c=this,d=c.configs,e=d.hideColumns;if(gid=d.gid,f=c.getColumnList(),-1==c.inArray(a,f))return!1;if(g="show"==b?!0:!1)for(h in e)e[h]==a&&(e[h]=null);
else-1==c.inArray(a,e)&&e.push(a);return $(gid).find("td[field='"+a+"']")[b](),c.fireEvent("onViewSizeChange",c),c.setGroupRowSize(),c.setExpandRowSize(),!0},showColumn:function(a){var b=this;return b.displayColumn(a,"show")},hideColumn:function(a){var b=this;return b.displayColumn(a,"hide")},sortColumn:function(a){var e,b=this,c=b.configs,d=c.gid;a=a||!1,0!=a&&(e=e||d+" .datagrid-view2 .datagrid-header",$(e).find("td[field='"+a+"']").find("div.datagrid-cell").click(function(){var f,d=$(this).parent().attr("field");c.sortName=d,f=b.fireEvent("onSortColumn",b,[d]),f!==!1&&($(this).hasClass("datagrid-sort-asc")?($(e).find("div.datagrid-cell").removeClass("datagrid-sort-asc").removeClass("datagrid-sort-desc"),$(this).removeClass("datagrid-sort-asc"),$(this).addClass("datagrid-sort-desc"),c.sortOrder="desc"):($(e).find("div.datagrid-cell").removeClass("datagrid-sort-asc").removeClass("datagrid-sort-desc"),$(this).removeClass("datagrid-sort-desc"),$(this).addClass("datagrid-sort-asc"),c.sortOrder="asc"),b.refreshData())}))},setGridHeaderEvent:function(a){var f,g,h,i,c=this,d=c.configs;if(d.gid,f=d.columns,d.fitColumns){g=$.extend({},d),g.self=c,g.stop=function(a,b){var d=c.fireEvent("onResizeColumnStop",c,[b]);return d===!1?d:(c.cStop(b),void 0)};for(h in f)f[h].fitColumn&&a.find("td[field='"+f[h].field+"'] div.datagrid-cell")._resize(g)}for(h in f)1==f[h].sortable?c.sortColumn(f[h].field):a.find("td[field='"+f[h].field+"'] div.datagrid-cell >.datagrid-sort-icon").hide();d.sortName&&a.find("td[field='"+d.sortName+"']  div.datagrid-cell").addClass("datagrid-sort-"+d.sortOrder.toLowerCase()),a.bind("contextmenu",function(a){var b=c.fireEvent("onHeaderContextMenu",c,[this,a]);return 0==b?!1:void 0}),a.find(">td,td[field]").hover(function(a){$(this).addClass("datagrid-header-over"),c.fireEvent("onColumnOver",c,[this,a])},function(a){$(this).removeClass("datagrid-header-over"),c.fireEvent("onColumnOut",c,[this,a])}),c.setGridHeaderTextLimit(),d.checkBox&&(i=a.find("td[field='ck']"),i.find(".datagrid-sort-icon").hide(),i.find("input:checkbox").click(function(){return d.singleSelect?(this.checked=!1,!1):(this.checked?c.selectAllRows():c.unselectAllRows(),void 0)}))},setGridHeaderTextLimit:function(){var e,f,g,h,i,j,a=this,b=a.configs,c=b.gid,d=c;if(!b.textLimit)return!1;e=b.columns;for(f in e)e[f].textLimit!==!1&&(g=$(d).find(".datagrid-header-row td[field='"+e[f].field+"']").find("div.datagrid-cell"),h=g.width(),i=g.css("fontSize"),j=a.getColumnData(e[f].field,"title"),j=a.textLimit(j,h,i),g.find("span").first().html(j))},setGridHeader:function(){var d,e,f,g,h,i,j,k,l,a=this,b=a.configs;return b.gid,d=a.getColumns(),e=a.getTpl("view1_header_inner_row"),f=b.headerTpl?b.headerTpl:a.getTpl("view2_header_inner_row"),g=$("#view2-datagrid-header-inner-htable-tbody-"+b.id),h=$("#view1-datagrid-header-inner-htable-tbody-"+b.id),i=$("#view2-datagrid-header-outer-locktable-tbody-"+b.id),j=$("#view1-datagrid-header-outer-locktable-tbody-"+b.id),k=$(a.tpl(e,b)),l=$(a.tpl(f,{fields:d,opt:b})),g.html(""),h.html(""),i.html(""),j.html(""),h.append(k),g.append(l),a.fireEvent("onHeaderCreate",a,[]),a.setGridHeaderEvent(l,k),a.methodCall("setGridHeader"),b.moveColumns&&l.find("td[field]").moveColumn(b),!0},onHeaderCreate:function(){var fields,headerBody,_columns,_thex,self=this,opt=self.configs,gid=opt.gid;return opt.headerTpl?(fields=opt.columns,headerBody=$("#view2-datagrid-header-inner-htable-tbody-"+opt.id),_columns=[],_thex=$.dataGrid.getToGridOptions(),headerBody.find(">tr td[field],>tr th[field],>tr td["+_thex.options_from+"],>tr th["+_thex.options_from+"]").each(function(i){var _d2,_d3,j,_d4,$this,field=$(this).attr("field"),_d=$(this).attr(_thex.options_from);_d=_d?eval("({"+_d+"})"):{},field||(field=_d.field?_d.field:"field_"+99999*Math.random()),_d2={},_d2.title=$(this).html(),_d3={};for(j in fields)if(fields[j].field==field){_d3=fields[j];break}$.isEmptyObject(_d3)&&(_d3.field=field),_d.width=_d.width?_d.width:$(this).width(),_d.width-=opt.padding,_d4=$.extend(!0,{},_d,_d2,_d3),_d4.align=_d4.align?_d4.align:$(this).attr("align")?$(this).attr("align"):opt._columnMetaData.align,_d4.hcls=_d4.hcls?_d4.hcls:opt._columnMetaData.hcls,$this=this,$(this).is("th")?($this=$('<td field="'+_d4.field+'" align="'+_d4.align+'"></td>'),$(this).replaceWith($this)):($(this).attr("field",_d4.field),$(this).attr("align",_d4.align)),$($this).html('<div class="datagrid-header-wrap" field="'+_d4.field+'"><div class="datagrid-cell '+_d4.hcls+'" style="width:'+parseFloat(_d4.width)+'px"><span>'+_d4.title+'</span><span class="datagrid-sort-icon">&nbsp;</span></div></div>'),_columns.push(_d4)}),opt.columns=_columns,headerBody.find(">tr").addClass("datagrid-header-row"),headerBody.find(">tr")):-1},setColumnValue:function(a,b,c){var f,d=this,e=d.getColumns();for(f in e)e[f].field!=a||(e[f][b]=c)},cStop:function(a){var f,b=this,c=b.configs,d=c.gid,e=$(d).find("td[field='"+a.field+"']").find("div.datagrid-cell");e.size()&&(f=parseFloat(e.width()),f+=a.offsetX,f=10>f?10:f,b.setColumnValue(a.field,"width",f),e.width(f),b.fireEvent("onScroll",b,[!0]),b.setGridHeaderTextLimit(),b.setGridBodyTextLimit(a.field),b.fireEvent("onViewSizeChange",b,[]),b.setGroupRowSize(),b.setExpandRowSize())},setGroupRowSize:function(){var d,e,a=this,b=a.configs,c=b.gid;b.groupBy&&(d=c+" .datagrid-view2",e=$(d).find(".datagrid-header-row").first().width(),$(d).find(".datagrid-group-row td").width(e))},changeExpandPos:function(){var a=this,b=a.configs;b.gid,$("#view2-datagrid-body-btable-tbody-"+b.id).find(".datagrid-row-expand").each(function(){if(!$(this).is(":hidden")){var c=$(this).attr("datagrid-expand-row-index");a.expandRow(c,"")}})},setExpandRowSize:function(){var a=this,b=a.configs,c=b.gid,d=c+" .datagrid-view2";$(d).find(".datagrid-row-expand").each(function(){var c=$(this).attr("datagrid-expand-row-index"),d=$("#"+b.id+"-row-"+c),e=0;d.find(">td >.datagrid-cell").each(function(){$(this).is(":hidden")||(e+=$(this).width())}),$(this).find(".datagrid-cell-expand").width(e)})},isRowHidden:function(a){var b=this,c=b.configs;return c.gid,void 0===a?!0:$("#"+c.id+"-row-"+a).size()&&!$("#"+c.id+"-row-"+a).is(":hidden")?!1:!0},isExpandRowShow:function(a){var e,b=this,c=b.configs;return c.gid,e=c.id+"-expand-row-"+a,$("#"+e).size()&&!$("#"+e).is(":hidden")?!0:!1},expandRow:function(a,b){var g,h,i,j,k,l,m,n,o,p,q,r,c=this,d=c.configs;if(d.gid,d.events,a="undefined"==typeof a?!1:a,a===!1)return c;if(b="undefined"==typeof b?"":b,g=c.getRowData(a),b=c.tpl(b,g),h=$("#"+d.id+"-row-"+a),i=$("#"+d.id+"-view1-row-"+a),h.size()<=0)return c;if(j=d.id+"-expand-row-"+a,$("#"+j).size())h.after($("#"+j));else{k=0,h.find(">td >.datagrid-cell").each(function(){$(this).is(":hidden")||(k+=$(this).width())}),l=$("<tr id='"+j+"' class='datagrid-row-expand' datagrid-expand-row-index='"+a+"'><td colspan='"+d.columns.length+"'><div class=' datagrid-cell-expand' style='overflow:hidden;width:"+k+"px'></div></td></tr>");try{$(b).size()?l.find("div.datagrid-cell-expand").append($(b).show()):l.find("div.datagrid-cell-expand").html(b)}catch(f){l.find("div.datagrid-cell-expand").html(b)}h.after(l)}if(m=d.id+"-expand-view1-row-"+a,d.rowNumbersWidth!==!1||d.lockColumns.length){if($("#"+m).remove(),n=0,o="",d.lockColumns.length)for(p in d.lockColumns)null!=d.lockColumns[p]&&n++;n&&(o='<td colspan="'+n+'" class="datagrid-cell-rownumber-expand"></td>'),q=$("<tr id='"+m+"' style='overflow:hidden;'  class='datagrid-row datagrid-row-view1' datagrid-expand-row-index='"+a+"'><td class='datagrid-td-rownumber'><div class='datagrid-cell-view1-expand'></div></td>"+o+"</tr>"),i.after(q),r=$("#"+j).height(),$("#"+m).height(r),r!=$("#"+m).height()&&(r=$("#"+m).height(),$("#"+m).height(r-1))}l=$.dataGrid._undef(l,$("#"+j)),q=$.dataGrid._undef(q,$("#"+m)),c.isRowHidden(a)?(l.hide(),q.hide()):(l.show(),q.show()),r=l.height(),q.css({height:r}),c.fireEvent("onExpandRow",c,[a]),c.fireEvent("onViewSizeChange",c,[])},hideExpandRow:function(a){var e,f,b=this,c=b.configs;return c.gid,a="undefined"==typeof a?!1:a,a===!1?b:(e=c.id+"-expand-row-"+a,f=c.id+"-expand-view1-row-"+a,$("#"+e).hide(),$("#"+f).hide(),b.fireEvent("onViewSizeChange",b,[]),void 0)},destroyExpandRow:function(a){var e,f,b=this,c=b.configs;return c.gid,a="undefined"==typeof a?!1:a,a===!1?b:(e=c.id+"-expand-row-"+a,f=c.id+"-expand-view1-row-"+a,$("#"+e).remove(),$("#"+f).remove(),b.fireEvent("onViewSizeChange",b,[]),void 0)},updateExpandRow:function(a,b){var c=this;c.destroyExpandRow(a),c.expandRow(a,b)},selectAllRows:function(){var e,f,a=this,b=a.configs;if(b.gid,b.events,b.singleSelect)return a;if(e=a.fireEvent("onSelectAll",a,[]),e===!1)return a;for(f in b.data)a.selectRow(f);return a},unselectAllRows:function(){var e,f,g,a=this,b=a.configs;if(b.gid,b.events,e=a.fireEvent("onUnselectAll",a,[]),e===!1)return a;f=a.getSlectRows();for(g in f)a.unselectRow(f[g]);return a},addSelectRecode:function(){},removeSelectRecode:function(){},selectRow:function(a){var g,h,i,j,k,l,b=this,c=b.configs;if(c.gid,c.events,a="undefined"==typeof a?!1:a,a===!1)return b;if(g=b.getRowData(a),h=$("#"+c.id+"-row-"+a+",#"+c.id+"-view1-row-"+a),h.size()<=0)return b;if(i=b.fireEvent("onSelect",b,[h,a,g]),i===!1)return i;if(h.attr("datagrid-row-select","1").addClass("datagrid-row-selected"),c.checkBox&&(j=h.find("td[field='ck'] .datagrid-cell-check input:checkbox"),j.length&&(j.get(0).checked=!0)),k=b.getSlectRows(),k.length&&c.singleSelect)for(l=0;l<k.length;l++)k[l]!=a&&b.unselectRow(k[l]);return b},unselectRow:function(a){var g,h,i,j,b=this,c=b.configs;return c.gid,c.events,a="undefined"==typeof a?!1:a,a===!1?b:(g=b.getRowData(a),h=$("#"+c.id+"-row-"+a+",#"+c.id+"-view1-row-"+a),h.size()<=0?b:(i=b.fireEvent("onUnselect",b,[h,a,g]),i===!1?i:(h.attr("datagrid-row-select","0").removeClass("datagrid-row-selected"),c.checkBox&&(j=h.find("td[field='ck'] .datagrid-cell-check input:checkbox"),j.length&&(j.get(0).checked=!1)),b)))},showGroup:function(a,b){var h,i,c=this,d=c.configs,e=d.gid,f=e+" .datagrid-view2",g=e+" .datagrid-view1";return b=$.dataGrid._undef(b,"show"),"undefined"==typeof a?c:(h=$(f).find("tr[datagrid-group-id='"+a+"']"),i=$(g).find("tr[datagrid-group-id='"+a+"']"),h[b](),i[b](),h.each(function(){var d=$(this).attr("datagrid-row-index"),e=c.getRowData(d);e._openExpand=$.dataGrid._undef(e._openExpand,!1),e._openExpand&&c.expandRow(d,e._expand),"hide"==b&&c.hideExpandRow(d)}),"show"==b?($(f).find("#"+d.id+"-group-row-"+a).find("div.datagrid-group-cell").addClass("datagrid-group-cell-select"),$(g).find("#"+d.id+"-group-view1-row-"+a).find("div.datagrid-group-cell-rownumber").addClass("datagrid-group-cell-rownumber-select")):($(f).find("#"+d.id+"-group-row-"+a).find("div.datagrid-group-cell").removeClass("datagrid-group-cell-select"),$(g).find("#"+d.id+"-group-view1-row-"+a).find("div.datagrid-group-cell-rownumber").removeClass("datagrid-group-cell-rownumber-select")),c.fireEvent("onScroll",c,[!0]),c.fireEvent("onViewSizeChange",c,[]),c)},hideGroup:function(a){var b=this;return b.showGroup(a,"hide")},addGroupRow:function(a){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,b=this,c=b.configs,d=c.gid,e=d+" .datagrid-view2",f=d+" .datagrid-view1";if(!c.groupBy)return!1;a=$.dataGrid._undef(a,!1),a&&($("#view2-datagrid-body-btable-tbody-"+c.id).find("> tr").hide(),$("#view1-datagrid-body-btable-tbody-"+c.id).find("> tr").hide()),g=$(e).find(".datagrid-header-row").width(),h="",c.rowNumbersWidth!==!1&&(h="datagrid-group-cell-rownumber"),i=c.lockColumns,j=0;for(k in i)null!=i[k]&&j++;for(k in c.groupList){if(c._groupListData[k]=$.dataGrid._undef(c._groupListData[k],[]),l=b.tpl(b.getTpl("group_row"),{gid:k,w:parseFloat(g),id:c.id,colspan:c.columns.length-j,html:c.groupList[k],num:c._groupListData[k].length}),m=$(e).find(".datagrid-body tr[datagrid-group-id='"+k+"']"),m.size()<=0&&(m=$(e).find(".datagrid-header .datagrid-header-outer .datagrid-locktable tr[datagrid-group-id='"+k+"']")),n=$(f).find("tr[datagrid-group-id='"+k+"']"),o="<tr id='"+c.id+"-group-view1-row-"+k+"' datagrid-group-row-id='"+k+"' class='datagrid-group-row-view1'><td colspan='"+(j+1)+"'><div class='"+h+"'></div></td></tr>",p=$(l),q=$(o),$("#"+c.id+"-group-row-"+k).size())$("#"+c.id+"-group-row-"+k).replaceWith(p),$("#"+c.id+"-group-view1-row-"+k).replaceWith(q),m.first().is(":hidden")||q.find("div.datagrid-group-cell-rownumber").addClass("datagrid-group-cell-rownumber-select");else if(m.size())p.insertBefore(m.first()),q.insertBefore(n.first()),m.first().is(":hidden")||q.find("div.datagrid-group-cell-rownumber").addClass("datagrid-group-cell-rownumber-select");else{for(r=k-1;r>=0;r--)if(s=$(e).find("tr[datagrid-group-id='"+k+"']"),t=$(f).find("tr[datagrid-group-id='"+k+"']"),s.size()){p.insertAfter(s.last()),q.insertAfter(t.first());break}0>r&&(p.appendTo($(e).find(".datagrid-body .datagrid-btable tbody")),q.appendTo($(f).find(".datagrid-body .datagrid-btable tbody")))}u=p.height(),q.height(u),u!=q.height()&&q.height(u-1),c.groupListCallBack.call(b,p.find(".datagrid-group-cell"),c.groupList[k],c._groupListData[k])}b.setGroupEvent()},setGroupEvent:function(){var f,a=this,b=a.configs,c=b.gid,d=c+" .datagrid-view2",e=c+" .datagrid-view1";for(f in b.groupList)$(d).find("#"+b.id+"-group-row-"+f).click(function(){var b=$(this).attr("datagrid-group-row-id"),c=$(this).find(".datagrid-group-cell");c.hasClass("datagrid-group-cell-select")?a.hideGroup(b):a.showGroup(b)}),$(e).find("#"+b.id+"-group-view1-row-"+f).click(function(){var b=$(this).attr("datagrid-group-row-id"),c=$(this).find(".datagrid-group-cell-rownumber");c.hasClass("datagrid-group-cell-rownumber-select")?a.hideGroup(b):a.showGroup(b)})},groupByField:function(a,b,c){var g,h,i,j,k,l,m,n,o,d=this,e=d.configs;if(e.gid,a=$.dataGrid._undef(a,e.groupBy),b=$.dataGrid._undef(b,e.data),c=$.dataGrid._undef(c,e.groupList),e._groupList=$.dataGrid._undef(e._groupList,e.groupList),a===!1)return d;for(g=d.getColumns(),h=!1,i=0;i<g.length;i++)if(g[i].field==a){h=a;break}if(h===!1)return e.groupBy=h,d;if(a=h,e.groupBy=a,j=[],e._groupList===!1)for(c=[],i=0;i<b.length;i++)-1===d.inArray(b[i][a],c)&&c.push(b[i][a]);for(e.groupList=c,k=0;k<c.length;k++){for(l=[],m=0;m<b.length;m++)b[m][a]==c[k]&&(b[m]._groupid_=k,l.push(b[m]));j[k]=l,l=[]}e._groupListData=j,b=[];for(n in j)for(o=0;o<j[n].length;o++)b.push(j[n][o]);return e.data=b,d},searchData:function(a,b,c,d){var h,i,j,k,l,e=this,f=e.configs;if(f.gid,a=$.dataGrid._undef(a,null),null==a)return e;if(e.clearSearch(!1),b=$.dataGrid._undef(b,!1),h=e.getColumns(),b!==!1){for(i=!1,j=0;j<h.length;j++)if(h[j].field==b){i=b;break}b=i}if(c=$.dataGrid._undef(c,!0),f.cacheData.searchAsync=c,c){for(d=$.dataGrid._undef(d,f.cacheData.searchData||f.cacheData.source||f.data),1!=f.cacheData.searched&&(f.cacheData.searchData=f.cacheData.searchData||d,f.cacheData._url=f.url,f.cacheData._pageNumber=f.pageNumber,f.cacheData._data=f.data,f.url="",f.pageNumber=1),k=[],j=0;j<d.length;j++)if(b!==!1)-1!=d[j][b].toString().indexOf(a)&&k.push(d[j]);else for(l=0;l<h.length;l++)if(-1!=d[j][h[l].field].toString().indexOf(a)){k.push(d[j]);break}e.setGridData(k,!0),e.showGrid(function(){e.fireEvent("onSearch",e,[k]),e.setGridBody()},$.noop,!0)}else 1!=f.cacheData.searched&&(f.cacheData._pageNumber=f.pageNumber,f.pageNumber=1),f.queryParams.searchText=a,f.queryParams.searchField=b,e.showGrid(function(){e.fireEvent("onSearch",e,[f.data]),e.setGridBody()});return f.cacheData.searched=!0,e},clearSearch:function(a){var b=this,c=b.configs;if(c.gid,c.cacheData.searched!==!0)return b;a=$.dataGrid._undef(a,!0),c.cacheData.searched=!1,b.setGridData(c.cacheData.searchData),c.url=c.cacheData._url||c.url,c.pageNumber=c.cacheData._pageNumber||c.pageNumber,c.data=c.cacheData._data||c.data;try{delete c.cacheData._url}catch(e){}try{delete c.cacheData._pageNumber}catch(e){}try{delete c.cacheData.searchData}catch(e){}try{delete c.cacheData._data}catch(e){}try{delete c.queryParams.searchText}catch(e){}try{delete c.queryParams.searchField}catch(e){}return c.cacheData.searchAsync||delete c.cacheData.source,a&&(c.cacheData.searchAsync?b.refreshDataCache():b.refreshData()),delete c.cacheData.searchAsync,b},onOverRow:function(a){var b=this,c=b.configs,d=c.gid,e=$(d).find("tr[datagrid-row-index='"+a+"']");e.addClass("datagrid-row-over")},onOutRow:function(a){var b=this,c=b.configs,d=c.gid,e=$(d).find("tr[datagrid-row-index='"+a+"']");e.removeClass("datagrid-row-over")},setGridBodyTextLimit:function(a,b){var g,h,i,j,m,n,o,p,q,r,c=this,d=c.configs,e=d.gid,f=e;if(!d.textLimit)return!1;if("undefined"==typeof a){b=d.data,g=d.columns;for(h in g)g[h].textLimit!==!1&&(i=$(f).find(".datagrid-view2 .datagrid-body td[field='"+g[h].field+"']"),i.each(function(){var f,i,j,b=$(this).parent().attr("datagrid-row-index"),d=c.getRowData(b),e=$(this).find("div.datagrid-cell").html();"undefined"==typeof d[g[h].field]&&c.setRowData(b,g[h].field,e),e=d[g[h].field],f=$(this).find("div.datagrid-cell").width(),i=$(this).find("div.datagrid-cell").css("fontSize"),j=e,j=c.textLimit(j,f,i),$(this).find("div.datagrid-cell").html(j)}))}else if(2==arguments.length){j=a,g=d.columns,j.attr("datagrid-row-index"),b=b,m="";for(h in g)g[h].textLimit!==!1&&(m=$.dataGrid._undef(b[g[h].field],""),""!=m&&(n=j.find("td[field='"+g[h].field+"'] div.datagrid-cell"),o=n.width(),p=n.css("fontSize"),q=m,q=c.textLimit(q,o,p),n.html(q)))}else r=c.getColumnData(a,"textLimit"),r&&(i=$(f).find(".datagrid-row td[field='"+a+"']"),i.each(function(){var g,h,i,d=$(this).parent().attr("datagrid-row-index"),e=c.getRowData(d),f=$(this).find("div.datagrid-cell").html();"undefined"==typeof e[a]&&c.setRowData(d,a,f),f=e[a],g=$(this).find("div.datagrid-cell").width(),h=$(this).find("div.datagrid-cell").css("fontSize"),i=f,i=c.textLimit(i,g,h),$(this).find("div.datagrid-cell").html(i)}))},bindRowEvent:function(a,b){var g,h,i,j,k,l,m,c=this,d=c.configs;if(d.data,d.gid,"undefined"==typeof a&&(a=!1),"undefined"==typeof b&&(b=!1),g=d.columns,a?(h=a.attr("datagrid-row-index"),i=c.getRowData(h)):b&&(h=b.attr("datagrid-row-index"),i=c.getRowData(h)),a&&(a.click(function(a){var e,f,b=c.fireEvent("onClickRow",c,[this,h,i,a]);return b===!1?!1:(e=$(this).attr("datagrid-row-select"),f=c.getSlectRows(),"1"==e?d.singleSelect?1==f.length&&f[0]!=h&&c.unselectRow(h):c.unselectRow(h):c.selectRow(h),void 0)}),a.hover(function(a){c.fireEvent("onOverRow",c,[h,a])},function(a){c.fireEvent("onOutRow",c,[h,a])}),a.dblclick(function(a){var b=c.fireEvent("onDblClickRow",c,[this,h,i,a]);return 0==b?!1:void 0}),a.find("> td div.datagrid-cell").click(function(a){var b=$(this).parent("td").attr("field"),d=c.getFieldValue(h,b),e=c.fireEvent("onClickCell",c,[this,h,b,d,a]);return 0==e?!1:void 0}),a.find("> td div.datagrid-cell").dblclick(function(a){var b=$(this).parent("td").attr("field"),d=c.getFieldValue(h,b),e=c.fireEvent("onDblClickCell",c,[this,h,b,d,a]);return 0==e?!1:void 0}),a.bind("contextmenu",function(a){var b=c.fireEvent("onRowContextMenu",c,[this,h,i,a]);return 0==b?!1:void 0})),a){j=[];for(k in g)j=g[k],$.isFunction(j.callBack)&&j.callBack!=d.noop&&(l=a.find("td[field='"+j.field+"'] > div.datagrid-cell"),j.callBack.call(c,l,h,j,i));$.isFunction(d.rowCallBack)&&d.rowCallBack!=$.noop&&d.rowCallBack.call(c,a,h,i),d.rowStyler&&($.isFunction(d.rowStyler)?(m=d.rowStyler.call(c,a,h,i),"string"==typeof m&&a.addClass(m)):"string"==typeof d.rowStyler&&a.addClass(d.rowStyler))}b&&(b.click(function(a){var b=h;c.fireEvent("onClickRowNumber",c,[b,a]),d.rowNumbers2Row!==!1&&$("#"+d.id+"-row-"+b).click()}),b.hover(function(a){c.fireEvent("onOverRow",c,[h,a])},function(a){c.fireEvent("onOutRow",c,[h,a])})),a&&c.setGridBodyTextLimit(a,i)},setRow:function(a,b){var g,h,i,j,k,l,m,n,o,p,q,c=this,d=c.configs,e=d.data;for(d.gid,g=c.getColumns(),h=c.getTpl("view1_row"),i=d.rowTpl?d.rowTpl:c.getTpl("view2_row"),j={},k=$("#view2-datagrid-body-btable-tbody-"+d.id),l=$("#view1-datagrid-body-btable-tbody-"+d.id),b=$.dataGrid._undef(b,$.noop),a=$.dataGrid._undef(a,0),a||(k.html(""),l.html("")),m=d._lSize,n=1,o=a;o<e.length;o++){if(n>m){setTimeout(function(){c.setRow(o,b)},d._lTime);break}n++,j={i:o,id:d.id,fields:g,rowNumbersExpand:d.rowNumbersExpand?d.rowNumbersExpand:!1,data:e[o],isCreate:d.isCreate,groupBy:d.groupBy,rowNumbersWidth:d.rowNumbersWidth,opt:d},p=$(c.tpl(i,j)),$(k).append(p),d.rowTpl&&(p.find(">td,>th").each(function(a){var b=this;$(this).is("th")?(b=$("<td field='"+g[a].field+"' align='"+g[a].align+"'><div class='datagrid-cell datagrid-cell-c1-"+g[a].field+" ' style='width:"+g[a].width+";'>"+$(this).html()+"</div></td>"),$(this).replaceWith(b)):$(this).attr("field",g[a].field).attr("align",g[a].align).html("<div class='datagrid-cell datagrid-cell-c1-"+g[a].field+" ' style='width:"+g[a].width+";'>"+$(this).html()+"</div>")}),p.addClass("datagrid-row").attr("id",d.id+"-row-"+o).attr("datagrid-row-index",o).attr("datagrid-row-select",0),"undefined"!=typeof e[o]._groupid_&&p.attr("datagrid-group-id",e[o]._groupid_)),q=!1,d.rowNumbersWidth!==!1&&(q=$(c.tpl(h,j)),$(l).append(q)),c.bindRowEvent(p,q)}o>=e.length?(b(),c.afterGridShow()):c.fireEvent("onShowGriding",c,[o,e])},onBeforeShowGrid:function(){var d,a=this,b=a.configs;if(b.gid,b.lockColumns.length)for(d in b.lockColumns)if(null!=b.lockColumns[d])return a.setGridHeader(),void 0;if(b.lockRows.length)for(d in b.lockRows)if(null!=b.lockRows[d])return a.setGridHeader(),void 0},setGridBody:function(a,b){var h,i,c=this,d=c.configs;return d.gid,c.showLoading(),$("#view2_"+d.id),b=b||$.noop,c.groupByField(),d.data,c.fireEvent("onBeforeShowGrid",c,[]),c.fireEvent("onViewSizeChange",c,[]),c.setPager(),h=d.sLeft,i=d.sTop,c.setRow(0,function(){b(),d.sLeft=h,d.sTop=i}),c.hideLoading(),!0},afterGridShow:function(){var a=this,b=a.configs;b.gid,a.onFinishDone=a.onFinishDone||!1,a.onFinishDone||(a.onFinishDone=!0,a.fireEvent("onFinish",a)),a.addGroupRow(!0),a.fireEvent("onScroll",a,[!0]),a.methodCall("setGridBody"),a.fireEvent("onViewSizeChange",a,[]),a.fireEvent("onShowGrid",a,[])},setGridFooter:function(){var a=this,b=a.configs;return b.gid,!0},onScroll:function(a){var b=this,c=b.configs;c.gid,a=$.dataGrid._undef(a,!1),a&&(c.gbody.scrollLeft(c.sLeft),c.gbody.scrollTop(c.sTop)),c.sLeft=c.gbody._scrollLeft(),c.sTop=c.gbody._scrollTop(),$("#view2-datagrid-header-inner-"+c.id).find(">.datagrid-header-inner-wraper")._scrollLeft(c.sLeft),$("#view2-datagrid-header-outer-"+c.id).find(">.datagrid-header-outer-wraper")._scrollLeft(c.sLeft),$("#view1-datagrid-body-"+c.id)._scrollTop(c.sTop)},showGrid:function(a,b,c){var d=this,e=d.configs;e.gid,a=a||$.noop,b=b||$.noop,c=$.dataGrid._undef(c,!1),d.getGridData(function(){d.fireEvent("onGetData",d,[e.data]),a.apply(this,arguments)},function(){b.apply(this,arguments)},c)},refreshData:function(){var b,c,d,e;this.configs.events,b=this,c=b.configs,d=c.gid,e=e||d+" .datagrid-view2",b.fireEvent("onBeforeRefresh",b),b.showGrid(function(){b.setGridBody(e,function(){b.fireEvent("onRefresh",b)})})},refreshDataCache:function(){this.configs.events;var b=this;b.setGridBody()},clearCache:function(){var a=this.configs;a.views=[],a.isCreate=!1,this.onFinishDone=!1,a.isShow=!1,a.pki=0},clearDataCache:function(a){var b=this.configs,c=b.cacheData;return b.cacheData=[],a=$.dataGrid._undef(a,!1),a||(b.cacheData.source=c.source,b.cacheData.columns=c.columns),this},reLoadGrid:function(a,b){var c=this.configs;b=$.dataGrid._undef(b,!1),this.clearCache(),this.clearDataCache(b),$.extend(c,a),$.dataGrid.call(this,c)},setWH:function(a,b){var c=this;return c.fireEvent("onSizeChange",c,[a,b]),c},C:function(a,b){return"undefined"==typeof a?this.configs:"undefined"==typeof b?this.configs[a]:(this.configs[a]=b,this)},createGrid:function(a){var b=this,c=b.configs,d=c.gid;return a=a||d+" .datagrid-view2",b.setGridHeader(a),b.showGrid(function(){b.setGridBody(a)}),b.setGridFooter(a),b.methodCall("createGrid"),b},sortData:function(a,b,c){var g,h,i,j,d=this,e=d.configs;if(e.gid,a=$.dataGrid._undef(a,e.sortName),""==a)return d;for(g=d.getColumns(),h=!1,i=0;i<g.length;i++)if(g[i].field==a){h=a;break}return h===!1?d:(e.cacheData.source=e.cacheData.source||e.data,b=$.dataGrid._undef(b,e.cacheData.source),c=$.dataGrid._undef(c,e.sortOrder),j="asc"==c?!0:!1,b.sort(function(b,c){return b[a]=$.dataGrid._undef(b[a],""),c[a]=$.dataGrid._undef(c[a],""),b[a]>=c[a]?j?1:-1:j?-1:1}),b)},onDataChange:function(){var b=this;b.configs,b.refreshData()},addData:function(a){var f,g,h,b=this,c=b.configs,d=b.getAsync(),e=$.dataGrid._undef(e,[]);if(e=$.isPlainObject(e)?[e]:e,f=c.pk,d){for(g=b.getData(),h=0;h<e.length;h++)a=e[h],a[f]=$.dataGrid._undef(a[f],b.unique()),g.push(a);b.fireEvent("onAdd",b,[e,!0]),b.fireEvent("onDataChange",b,[e])}else b.fireEvent("onAjaxAdd",b,[e,function(){b.onDataChange(e)}])},updateData:function(a){var e,f,g,h,i,j,b=this,c=b.configs,d=b.getAsync();if(a=$.dataGrid._undef(a,[]),a=$.isPlainObject(a)?[a]:a,e=c.pk,f=!1,d){for(g=0;g<a.length;g++)if(h=a[g],$.isPlainObject(h)&&(f=$.dataGrid._undef(h[e],!1),f!==!1)){i=b.getData();for(j in i)if(i[j][e]==h[e]){i[j]=h;break}}b.fireEvent("onUpdate",b,[a,!0]),b.fireEvent("onDataChange",b,[a])}else b.fireEvent("onAjaxUpdate",b,[a,function(){b.onDataChange(a)}])},deleteData:function(a){var e,f,g,h,i,j,k,l,b=this,c=b.configs,d=b.getAsync();if(a=$.dataGrid._undef(a,[]),a=$.isPlainObject(a)?[a]:a,e=c.pk,f=!1,d){for(g=b.getData(),h=0;h<a.length;h++)if(i=a[h],$.isPlainObject(i)&&(f=$.dataGrid._undef(i[e],!1),f!==!1)){for(j in g)if(g[j][e]==i[e])break;k=[];for(l in g)j!=l&&k.push(g[l]);g=k}b.fireEvent("onDelete",b,[a,!0]),b.fireEvent("onDataChange",b,[a])}else b.fireEvent("onAjaxDelete",b,[a,function(){b.onDataChange(a)}])},getAsync:function(){var a=this,b=a.configs;return b.gid,""==b.url||b.url===!1?!0:!1},setGridData:function(a,b,c){var d=this,e=d.configs;e.gid,b=$.dataGrid._undef(b,!1),c=$.dataGrid._undef(c,!1),0==b&&(b=d.getAsync()),b?e.cacheData.source=a:e.data=a,"_pk"==e.pk&&(e.pk="",d.fireEvent("onSetPk",d,[a])),c&&(b?d.showGrid(function(){d.setGridBody()},$.noop,!0):d.refreshDataCache())},onLoadSuccess:function(a){var c=this,d=c.configs;d.gid,d.data=a.rows,d.total=a.total,a.columns&&(d.columns=a.columns,c.setGridHeader())},onLoadError:function(a){var d=this,e=d.configs;e.gid,d.showLoading(a),setTimeout(function(){d.hideLoading(),d.refreshDataCache()},2e3)},getGridData:function(a,b,c){var g,h,i,j,k,d=this,e=d.configs,f=e.gid;if(a=a||$.noop,b=b||$.noop,g=f+" .datagrid-view2",c=$.dataGrid._undef(c,!1),0==c&&(c=d.getAsync()),d.methodCall("getGridData"),c){for(e.cacheData.source=e.cacheData.source||e.data,d.fireEvent("onSetPk",d,[e.cacheData.source]),""!=e.sortName&&(e.cacheData.source=d.sortData()),e.total=e.cacheData.source.length,h=(e.pageNumber-1)*e.pageSize,i=e.pageSize*e.pageNumber,i=i>e.total?e.total:i,j=[],k=h;i>k;k++)j.push(e.cacheData.source[k]);return e.data=j,a.call(d,g),void 0}e.queryParams.pageNumber=e.pageNumber,e.queryParams.pageSize=e.pageSize,""!=e.sortName&&(e.queryParams.sortName=e.sortName,e.queryParams.sortOrder=e.sortOrder),d.configs.events,$.ajax({url:e.url,type:e.method,cache:e.cache,dataType:e.dataType,data:e.queryParams,beforeSend:function(){d.fireEvent("onBeforeLoad",d,[e.queryParams]),d.showLoading()},success:function(b){d.hideLoading(),d.fireEvent("onLoadSuccess",d,[b,a]),a.call(d,g)},error:function(a){d.fireEvent("onLoadError",d,[a.responseText,b,a]),b.call(d,a.responseText)}})},setPk:function(a){var b=this,c=b.configs;""==c.pk&&(c.pki=1,c.pk="_pk",$.each(a,function(b){a[b][c.pk]=c.pki++}))},show:function(){var e,a=this,b=a.configs,c=b.views,d=$("#"+b.id);if(!b.isShow){b.isShow=!0;for(e in c)d.append(c[e]);a.setGrid(),a.setView(),a.createGrid(),a.methodCall("show")}}}),$.fn._scrollLeft=function(a){return void 0==a?this.scrollLeft():this.each(function(){$(this).css("marginLeft",-1*a)})},$.fn._scrollTop=function(a){return void 0==a?this.scrollTop():this.each(function(){$(this).css("marginTop",-1*a)})},$.fn.datagrid=function(a){if(this.size()<=0)return!1;var b=[];return this.each(function(){var f,d=$(this),e=$.extend(!0,{},a);e.selector=d.selector,e.helper=d,e.width=$.dataGrid._undef(e.width,d.width()),e.height=$.dataGrid._undef(e.height,d.height()),f=new $.dataGrid(e),d.data("datagrid",f),d.data("metaData",e),b.push(f)}),1==this.size()?this.data("datagrid"):b},$.fn.dataGrid=$.fn.datagrid,$.fn.togrid=function(cfg,_cfg){var list;return cfg=$.dataGrid._undef(cfg,{}),_cfg=$.dataGrid.getToGridOptions(_cfg),list=[],this.each(function(i){var opt,wh,columns,thead,avg_w,data,grid;$(this).css("display","block"),$(this).attr(_cfg.options_from)?(opt="{"+$(this).attr(_cfg.options_from)+"}",opt=eval("("+opt+")")):opt={},wh={width:$(this).outerWidth(),height:$(this).outerHeight(),title:$(this).attr("title")},columns=[],$(this).find(_cfg.columns_from).size()||(_cfg.columns_from="tr:first-child td,tr:first-child th"),thead=$(this).find(_cfg.columns_from),avg_w=0,(cfg.border!==!1||opt.border!==!1)&&(avg_w=2/thead.size()),thead.each(function(i){var column_a,column_b,column;void 0==$(this).attr("ignore")&&(column_a=$(this).attr("field")?{field:$(this).attr("field")}:{},$(this).attr(_cfg.options_from)?(column_b="{"+$(this).attr(_cfg.options_from)+"}",column_b=eval("("+column_b+")")):column_b={},column=$.extend({},column_b,column_a),column.title=$(this).html(),column.field=column.field?column.field:"field_"+99999*Math.random(),column.width=column.width?column.width:$(this).outerWidth()-1-1,$(this).attr("align")&&(column.align=$(this).attr("align")),"ck"==column.field&&(opt.checkBox=!0),"ed"==column.field&&(wh.editColumn=!0),columns.push(column))}),$(this).find(_cfg.columns_from).parent("tr").remove(),$(this).find(_cfg.data_from).size()||(_cfg.data_from="tr"),opt.columns=columns,opt=$.extend(!0,wh,opt,cfg),opt.url||(data=[],$(this).find(_cfg.data_from).each(function(){var b={};$(this).find(">td,>th").each(function(a){var c=$(this).html();$(this).attr("field")?b[$(this).attr("field")]=c:opt.columns[a].field&&(b[opt.columns[a].field]=c)}),data.push(b)}),opt.data=data),opt.helper=$("<div id='"+($(this).attr("id")?$(this).attr("id"):"")+"' class='datagrid "+$(this).attr("class")+"'></div>"),$(this).after(opt.helper).remove(),grid=new $.dataGrid(opt),opt.helper.data("metaData",opt),opt.helper.data("datagrid",grid),list.push(grid)}),1==this.size()?list[0]:list},$.fn.toGrid=$.fn.togrid,$.fn._resize=function(a){function c(a,b){var c,f,g,h,i;$(document.body).css("cursor","col-resize"),$(document.body).css("-moz-user-select","none"),$(document.body).attr("unselectable","on"),b.gheader.find(".datagrid-header-inner").css("cursor","col-resize"),b.gheader.find("div.datagrid-cell").css("cursor","col-resize"),c=$("<div class='datagrid-resize'></div>"),f="#view_"+b.id,$(f).append(c),g=$(this).offset().left-$(f).offset().left,h=$(f).height(),i=$(this).width(),g=parseFloat(g)+parseFloat(i),c.css({position:"absolute",borderLeft:"1px solid #aac5e7",top:0,zIndex:9999,height:parseFloat(h),left:g}),b.line=c,b.x=a.clientX,b.left=g,b.offsetX=0,$(document.body).bind("selectstart",function(){return!1}),$(document).bind("mousemove",function(a){var c=b.self.fireEvent("onResizeColumn",b.self,[b,a]);c!==!1&&d(a,b)}),$(document).bind("mouseup",function(a){b.stop(a,b),e(a,b)})}function d(a,b){var c=a.clientX,d=b.left+(c-b.x);b.offsetX=c-b.x,b.line.css({left:d})}function e(a,b){"#view_"+b.id,$(document).unbind("mousemove"),$(document).unbind("mouseup"),$(document.body).unbind("selectstart"),$(document.body).css("cursor","default"),$(document.body).removeAttr("unselectable"),b.gheader.find(".datagrid-header-inner").css("cursor","default"),b.gheader.find("div.datagrid-cell").css("cursor","default"),$(b.line).remove()}var b;a=a||{},a=$.extend({},a),b=this,b.each(function(){$("<div class='datagrid_resize'></div>").appendTo($(this).parent()).bind("mousedown",function(b){a.field=$(this).parent().attr("field");var d=a.self.fireEvent("onResizeColumnStart",a.self,[this,a,b]);d!==!1&&(c.call(this,b,a),b.preventDefault(),b.stopPropagation())})})},$.fn.moveColumn=function(a){function d(b){var d,e,f;c=!0,a.moveField=$(this).attr("field"),d=$('<div class="column-move" id="'+a.id+'_move" style="position:absolute;z-index:9999;">'+$(".datagrid-cell",this).html()+"</div>").appendTo("#"+a.id),e=$('<div class="column-move-line" id="'+a.id+'_line" style="position:absolute;height:'+$(this).outerHeight()+'px;"></div>').appendTo("#"+a.id),f=$("#"+a.id).offset(),d.css({left:b.pageX-f.left+10,top:b.pageY-f.top+10}),$(document.body).bind("mousemove.move",function(a){d.css({left:a.pageX-f.left+10,top:a.pageY-f.top+10}),a.preventDefault(),a.stopPropagation()
}),$(document.body).bind("mouseup.move",function(b){c=!1,d.remove(),e.remove(),$(document.body).unbind("mousemove.move mouseup.move"),a.self.fireEvent("onColumnMove",a.self,[a]),b.preventDefault(),b.stopPropagation()})}var b=this,c=!1;b.bind("mousedown.move",function(b){var c=this,e=setTimeout(function(){d.call(c,b)},a.moveColumnTm);$(document.body).bind("mouseup.wt",function(){clearTimeout(e),$(document.body).unbind("mouseup.wt")}),b.preventDefault(),b.stopPropagation()}),b.bind("mousemove.h",function(b){var d,e,f,g,h,i,j,k,l,m;0!=c&&(d=$("#"+a.id).offset(),e=d.top,f=d.left,g=$(this).outerWidth(),h=$(this).height()-2,i=$(this).offset().top-e,j=$(this).offset().left-f-2,k=b.pageX,l=k-$(this).offset().left,a.moveToField=$(this).attr("field"),m=a.self.fireEvent("onColumnMoving",a.self,[a]),m!==!1&&(g/2>=l?($("#"+a.id+"_line").css({left:j,top:i,height:h}),a.moveToFieldPos=1):($("#"+a.id+"_line").css({left:j+g,top:i,height:h}),a.moveToFieldPos=0)))})}}(jQuery);